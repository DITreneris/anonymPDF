==================================================================================== 2 errors in 10.87s ====================================================================================
(venv) PS C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF> pytest
=================================================================================== test session starts ====================================================================================
platform win32 -- Python 3.11.9, pytest-7.4.3, pluggy-1.6.0
benchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF
configfile: pytest.ini
testpaths: tests
plugins: anyio-3.7.1, hypothesis-6.92.1, asyncio-0.21.1, benchmark-4.0.0, cov-4.1.0, mock-3.12.0
asyncio: mode=Mode.STRICT
collected 386 items

tests\test_analytics_api.py ......F................                                                                                                                                   [  5%]
tests\test_analytics_engine.py EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE                                                                                                                       [ 14%]
tests\test_config_manager.py ...F.........                                                                                                                                            [ 17%]
tests\test_feedback_system.py ...................F.                                                                                                                                   [ 23%]
tests\test_intelligent_cache.py .......................FFFFF.                                                                                                                         [ 30%]
tests\test_memory_optimizer.py ..............................F                                                                                                                        [ 38%]
tests\test_ml_integration_layer.py EEEEEEEEE                                                                                                                                          [ 40%]
tests\test_morning_ses5_improvements.py ............FF                                                                                                                                [ 44%]
tests\test_pdf_processor.py .FF.                                                                                                                                                      [ 45%]
tests\test_performance.py ............F.                                                                                                                                              [ 49%]
tests\test_performance_enhanced.py .............EEEEE....FFFFFF                                                                                                                       [ 56%]
tests\test_performance_optimizer.py ....EEEEEEEEEE...FFFF                                                                                                                             [ 61%]
tests\test_pii_patterns.py .............                                                                                                                                              [ 65%]
tests\test_priority2_enhancements.py .............................                                                                                                                    [ 72%]
tests\test_real_time_monitor.py .........F........F....F.......                                                                                                                       [ 80%]
tests\test_training_data_collector.py .EFF.....F                                                                                                                                      [ 83%]
tests\test_validation_utils.py ...F..................                                                                                                                                 [ 88%]
tests\adaptive\test_ab_testing.py ......F.                                                                                                                                            [ 90%]
tests\adaptive\test_coordinator.py EEEEEE                                                                                                                                             [ 92%]
tests\adaptive\test_doc_classifier.py ........                                                                                                                                        [ 94%]
tests\adaptive\test_online_learner.py ....FF                                                                                                                                          [ 96%]
tests\adaptive\test_pattern_db.py ......                                                                                                                                              [ 97%]
tests\adaptive\test_pattern_learner.py .F                                                                                                                                             [ 98%]
tests\adaptive\test_processing_rules.py ....                                                                                                                                          [ 99%]
tests\system\test_adaptive_workflow.py EEE                                                                                                                                            [100%]

========================================================================================== ERRORS ==========================================================================================
________________________________________________________________ ERROR at setup of TestQualityAnalyzer.test_initialization _________________________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:33,083 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
_____________________________________________________________ ERROR at setup of TestQualityAnalyzer.test_add_detection_result ______________________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:33,451 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
____________________________________________________ ERROR at setup of TestQualityAnalyzer.test_add_detection_result_with_ground_truth _____________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:33,554 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
________________________________________________________ ERROR at setup of TestQualityAnalyzer.test_analyze_detection_quality_empty ________________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:33,655 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
___________________________________________________ ERROR at setup of TestQualityAnalyzer.test_analyze_detection_quality_single_category ___________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:33,751 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
_________________________________________________ ERROR at setup of TestQualityAnalyzer.test_analyze_detection_quality_multiple_categories _________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:33,849 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
______________________________________________ ERROR at setup of TestQualityAnalyzer.test_analyze_detection_quality_with_document_type_filter ______________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:33,951 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
__________________________________________________ ERROR at setup of TestQualityAnalyzer.test_analyze_detection_quality_with_ground_truth __________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:34,054 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
_____________________________________________________ ERROR at setup of TestQualityAnalyzer.test_detect_quality_issues_low_confidence ______________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:34,150 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
_________________________________________________ ERROR at setup of TestQualityAnalyzer.test_detect_quality_issues_performance_degradation _________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:34,249 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
___________________________________________________ ERROR at setup of TestQualityAnalyzer.test_detect_quality_issues_high_false_positive ___________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:34,335 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
___________________________________________________________ ERROR at setup of TestQualityAnalyzer.test_get_quality_report_empty ____________________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:34,435 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
_________________________________________________________ ERROR at setup of TestQualityAnalyzer.test_get_quality_report_with_data __________________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:34,546 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
_____________________________________________________ ERROR at setup of TestQualityAnalyzer.test_get_improvement_suggestions_no_issues _____________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:34,633 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
____________________________________________________ ERROR at setup of TestQualityAnalyzer.test_get_improvement_suggestions_with_issues ____________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:34,720 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
______________________________________________________________ ERROR at setup of TestQualityAnalyzer.test_storage_integration ______________________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:34,817 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
_____________________________________________________ ERROR at setup of TestQualityAnalyzer.test_get_quality_trends_insufficient_data ______________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:34,918 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
________________________________________________________ ERROR at setup of TestQualityAnalyzer.test_get_quality_trends_valid_metric ________________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:35,036 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
_________________________________________________________ ERROR at setup of TestQualityAnalyzer.test_get_quality_trends_declining __________________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:35,134 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
_______________________________________________________ ERROR at setup of TestQualityAnalyzer.test_get_quality_trends_invalid_metric _______________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:35,220 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
_________________________________________________________________ ERROR at setup of TestQualityAnalyzer.test_thread_safety _________________________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:35,317 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
______________________________________________________________ ERROR at setup of TestQualityAnalyzer.test_config_integration _______________________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:35,431 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
_________________________________________________________ ERROR at setup of TestQualityAnalyzer.test_ml_integration_compatibility __________________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:35,764 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
______________________________________________________________ ERROR at setup of TestQualityAnalyzer.test_performance_impact _______________________________________________________________
tests\test_analytics_engine.py:76: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:35,848 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
___________________________________________________ ERROR at setup of TestQualityInsightsGenerator.test_generate_pattern_insights_empty ____________________________________________________
tests\test_analytics_engine.py:525: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:35,930 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
_________________________________________________ ERROR at setup of TestQualityInsightsGenerator.test_generate_pattern_insights_with_data __________________________________________________
tests\test_analytics_engine.py:525: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:36,017 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
______________________________________________ ERROR at setup of TestQualityInsightsGenerator.test_generate_model_insights_insufficient_data _______________________________________________
tests\test_analytics_engine.py:525: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:36,116 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
_______________________________________________ ERROR at setup of TestQualityInsightsGenerator.test_generate_model_insights_excellent_model ________________________________________________
tests\test_analytics_engine.py:525: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:36,232 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
______________________________________________ ERROR at setup of TestQualityInsightsGenerator.test_generate_model_insights_needs_improvement _______________________________________________
tests\test_analytics_engine.py:525: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:36,316 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
______________________________________________________ ERROR at setup of TestQualityInsightsGenerator.test_generate_report_with_data _______________________________________________________
tests\test_analytics_engine.py:525: in setup_method
    self.analyzer = QualityAnalyzer(db_path=db_path)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:36,433 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
_______________________________________________________ ERROR at setup of TestAnalyticsEngineIntegration.test_engine_initialization ________________________________________________________
tests\test_analytics_engine.py:658: in setup_and_teardown
    self.engine = AnalyticsEngine(db_path=self.db_path)
app\core\analytics_engine.py:303: in __init__
    self.quality_analyzer = QualityAnalyzer(db_path=db_path, config=self.config)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:36,550 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
_______________________________________________________ ERROR at setup of TestAnalyticsEngineIntegration.test_full_analysis_workflow _______________________________________________________
tests\test_analytics_engine.py:658: in setup_and_teardown
    self.engine = AnalyticsEngine(db_path=self.db_path)
app\core\analytics_engine.py:303: in __init__
    self.quality_analyzer = QualityAnalyzer(db_path=db_path, config=self.config)
app\core\analytics_engine.py:94: in __init__
    analytics_logger.info("QualityAnalyzer initialized with database at %s", self.db_path)
E   TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:53:36,667 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
________________________________________________ ERROR at setup of TestMLIntegrationLayerFeedback.test_add_user_feedback_confirmed_correct _________________________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
__________________________________________________ ERROR at setup of TestMLIntegrationLayerFeedback.test_add_user_feedback_false_positive __________________________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
_______________________________________________ ERROR at setup of TestMLIntegrationLayerFeedback.test_add_user_feedback_category_correction ________________________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
_________________________________________________ ERROR at setup of TestMLIntegrationLayerFeedback.test_add_user_feedback_context_details __________________________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
___________________________________________________ ERROR at setup of TestMLIntegrationLayerFeedback.test_add_user_feedback_handles_uuid ___________________________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
_______________________________________ ERROR at setup of TestMLIntegrationLayerFeedback.test_add_user_feedback_handles_user_feedback_system_failure _______________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
____________________________________ ERROR at setup of TestMLIntegrationLayerDetectionProcessing.test_detect_with_ml_integration_calls_quality_analyzer ____________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
______________________________ ERROR at setup of TestMLIntegrationLayerDetectionProcessing.test_detect_with_ml_integration_calls_quality_analyzer_on_fallback ______________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
_______________________________________________ ERROR at setup of TestMLConfidenceScorerIntegration.test_adaptive_pattern_overrides_ml_model _______________________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
____________________________________________________ ERROR at setup of TestPerformanceOptimizedProcessor.test_processor_initialization _____________________________________________________
tests\test_performance_enhanced.py:331: in setup_method
    self.processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
__________________________________________________ ERROR at setup of TestPerformanceOptimizedProcessor.test_optimized_processing_session ___________________________________________________
tests\test_performance_enhanced.py:331: in setup_method
    self.processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
____________________________________________________ ERROR at setup of TestPerformanceOptimizedProcessor.test_parallel_file_processing _____________________________________________________
tests\test_performance_enhanced.py:331: in setup_method
    self.processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
_____________________________________________________ ERROR at setup of TestPerformanceOptimizedProcessor.test_empty_files_processing ______________________________________________________
tests\test_performance_enhanced.py:331: in setup_method
    self.processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
_______________________________________________ ERROR at setup of TestPerformanceOptimizedProcessor.test_single_file_processing_with_caching _______________________________________________
tests\test_performance_enhanced.py:331: in setup_method
    self.processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
__________________________________________________________ ERROR at setup of TestParallelProcessor.test_determine_processing_mode __________________________________________________________
tests\test_performance_optimizer.py:106: in setup_method
    self.processor = ParallelProcessor(config=config)
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
___________________________________________________________ ERROR at setup of TestParallelProcessor.test_process_single_document ___________________________________________________________
tests\test_performance_optimizer.py:106: in setup_method
    self.processor = ParallelProcessor(config=config)
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
__________________________________________________________ ERROR at setup of TestParallelProcessor.test_process_batch_sequential ___________________________________________________________
tests\test_performance_optimizer.py:106: in setup_method
    self.processor = ParallelProcessor(config=config)
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
_______________________________________________________ ERROR at setup of TestParallelProcessor.test_process_batch_parallel_threads ________________________________________________________
tests\test_performance_optimizer.py:106: in setup_method
    self.processor = ParallelProcessor(config=config)
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
________________________________________________________________ ERROR at setup of TestParallelProcessor.test_execute_task _________________________________________________________________
tests\test_performance_optimizer.py:106: in setup_method
    self.processor = ParallelProcessor(config=config)
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
___________________________________________________________ ERROR at setup of TestParallelProcessor.test_execute_task_with_error ___________________________________________________________
tests\test_performance_optimizer.py:106: in setup_method
    self.processor = ParallelProcessor(config=config)
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
___________________________________________________________________ ERROR at setup of TestBatchEngine.test_submit_batch ____________________________________________________________________
tests\test_performance_optimizer.py:215: in setup_method
    self.batch_engine = BatchEngine(config=config)
app\core\performance_optimizer.py:523: in __init__
    self.config = config or get_config()['performance']
E   KeyError: 'performance'
________________________________________________________________ ERROR at setup of TestBatchEngine.test_process_next_batch _________________________________________________________________
tests\test_performance_optimizer.py:215: in setup_method
    self.batch_engine = BatchEngine(config=config)
app\core\performance_optimizer.py:523: in __init__
    self.config = config or get_config()['performance']
E   KeyError: 'performance'
__________________________________________________________________ ERROR at setup of TestBatchEngine.test_get_queue_stats __________________________________________________________________
tests\test_performance_optimizer.py:215: in setup_method
    self.batch_engine = BatchEngine(config=config)
app\core\performance_optimizer.py:523: in __init__
    self.config = config or get_config()['performance']
E   KeyError: 'performance'
________________________________________________________________ ERROR at setup of TestBatchEngine.test_process_empty_queue ________________________________________________________________
tests\test_performance_optimizer.py:215: in setup_method
    self.batch_engine = BatchEngine(config=config)
app\core\performance_optimizer.py:523: in __init__
    self.config = config or get_config()['performance']
E   KeyError: 'performance'
_________________________________________________________ ERROR at teardown of TestTrainingDataStorage.test_storage_initialization _________________________________________________________
..\..\..\AppData\Local\Programs\Python\Python311\Lib\shutil.py:632: in _rmtree_unsafe
    os.unlink(fullname)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpmh2fx1h7\\training_data.db'

During handling of the above exception, another exception occurred:
tests\test_training_data_collector.py:50: in temp_db_dir
    with tempfile.TemporaryDirectory() as tmpdir:
..\..\..\AppData\Local\Programs\Python\Python311\Lib\tempfile.py:943: in __exit__
    self.cleanup()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\tempfile.py:947: in cleanup
    self._rmtree(self.name, ignore_errors=self._ignore_cleanup_errors)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\tempfile.py:929: in _rmtree
    _shutil.rmtree(name, onerror=onerror)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\shutil.py:787: in rmtree
    return _rmtree_unsafe(path, onerror)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\shutil.py:634: in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
..\..\..\AppData\Local\Programs\Python\Python311\Lib\tempfile.py:893: in onerror
    _os.unlink(path)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpmh2fx1h7\\training_data.db'
__________________________________________________________________________ ERROR at setup of test_initialization ___________________________________________________________________________
tests\adaptive\test_coordinator.py:25: in mock_subsystems
    with patch('app.core.adaptive.coordinator.PatternLearner') as MockPatternLearner, \
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the attribute 'PatternLearner'
_________________________________________________________________ ERROR at setup of test_process_feedback_and_learn_cycle __________________________________________________________________
tests\adaptive\test_coordinator.py:25: in mock_subsystems
    with patch('app.core.adaptive.coordinator.PatternLearner') as MockPatternLearner, \
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the attribute 'PatternLearner'
_________________________________________________________________ ERROR at setup of test_process_feedback_with_no_new_pii __________________________________________________________________
tests\adaptive\test_coordinator.py:25: in mock_subsystems
    with patch('app.core.adaptive.coordinator.PatternLearner') as MockPatternLearner, \
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the attribute 'PatternLearner'
______________________________________________________________________ ERROR at setup of test_ab_testing_integration _______________________________________________________________________
tests\adaptive\test_coordinator.py:25: in mock_subsystems
    with patch('app.core.adaptive.coordinator.PatternLearner') as MockPatternLearner, \
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the attribute 'PatternLearner'
_____________________________________________________________________ ERROR at setup of test_evaluate_and_log_ab_test ______________________________________________________________________
tests\adaptive\test_coordinator.py:25: in mock_subsystems
    with patch('app.core.adaptive.coordinator.PatternLearner') as MockPatternLearner, \
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the attribute 'PatternLearner'
___________________________________________________________________________ ERROR at setup of test_close_method ____________________________________________________________________________
tests\adaptive\test_coordinator.py:25: in mock_subsystems
    with patch('app.core.adaptive.coordinator.PatternLearner') as MockPatternLearner, \
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the attribute 'PatternLearner'
_________________________________________________________________________ ERROR at setup of test_fixture_creation __________________________________________________________________________
tests\system\test_adaptive_workflow.py:83: in adaptive_system_fixture
    quality_analyzer = QualityAnalyzer(storage_path=ANALYTICS_DB_PATH)
E   TypeError: QualityAnalyzer.__init__() got an unexpected keyword argument 'storage_path'
_________________________________________________________ ERROR at setup of test_feedback_creates_pattern_and_overrides_prediction _________________________________________________________
tests\system\test_adaptive_workflow.py:83: in adaptive_system_fixture
    quality_analyzer = QualityAnalyzer(storage_path=ANALYTICS_DB_PATH)
E   TypeError: QualityAnalyzer.__init__() got an unexpected keyword argument 'storage_path'
_____________________________________________________________________ ERROR at setup of test_ab_testing_full_lifecycle _____________________________________________________________________
tests\system\test_adaptive_workflow.py:83: in adaptive_system_fixture
    quality_analyzer = QualityAnalyzer(storage_path=ANALYTICS_DB_PATH)
E   TypeError: QualityAnalyzer.__init__() got an unexpected keyword argument 'storage_path'
========================================================================================= FAILURES =========================================================================================
_______________________________________________________________ TestAnalyticsEndpoints.test_get_anomaly_history_with_filters _______________________________________________________________
tests\test_analytics_api.py:341: in test_get_anomaly_history_with_filters
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 17:53:31,777 - anonympdf.api - INFO - Anomaly history requested - {"hours_back": 12, "severity": "high"}
2025-06-12 17:53:31,798 - config_manager - INFO - Patterns loaded from file - {"file": "config\\patterns.yaml", "patterns_count": 37}
2025-06-12 17:53:31,807 - config_manager - INFO - Cities loaded from file - {"file": "config\\cities.yaml", "cities_count": 79}
2025-06-12 17:53:31,833 - config_manager - INFO - Settings loaded from file - {"file": "config\\settings.yaml"}
2025-06-12 17:53:31,834 - config_manager - INFO - Configuration manager initialized - {"config_dir": "config", "patterns_count": 37, "cities_count": 79}
2025-06-12 17:53:31,834 - anonympdf.anonympdf.real_time_monitor - INFO - AnomalyDetector initialized with sensitivity: medium, alert_thresholds: 0
2025-06-12 17:53:31,836 - anonympdf.anonympdf.real_time_monitor - INFO - PerformanceAggregator initialized
2025-06-12 17:53:31,838 - anonympdf.anonympdf.real_time_monitor - INFO - RealTimeMonitor initialized
2025-06-12 17:53:31,853 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 17:53:31,853 - anonympdf.api - ERROR - Error generating anomaly history: StructuredLogger.info() takes 2 positional arguments but 3 were given
_____________________________________________________________________ TestConfigManager.test_configuration_validation ______________________________________________________________________
tests\test_config_manager.py:67: in test_configuration_validation
    assert is_valid is True
E   assert False is True
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 17:53:36,953 - config_manager - WARNING - Configuration validation failed - {"error_count": 10, "errors": ["Missing required setting: version", "Missing required setting: language_detection", "Missing required setting: processing", "Missing required setting: logging", "Missing required setting: anti_overredaction", "Missing required adaptive learning setting: enabled", "Missing required adaptive learning setting: databases", "Missing required adaptive learning setting: thresholds", "Missing required adaptive learning setting: performance", "Missing required adaptive learning setting: monitoring"]}
________________________________________________________ TestFeedbackSystemIntegration.test_feedback_submission_and_processing_flow ________________________________________________________
tests\test_feedback_system.py:499: in test_feedback_submission_and_processing_flow
    with patch.object(self.system.training_data_collector, 'save_training_examples') as mock_save:
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <app.core.training_data.TrainingDataCollector object at 0x000002B0B1097DD0> does not have the attribute 'save_training_examples'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:55:49,160 - anonympdf.anonympdf.feedback_system - INFO - FeedbackAnalyzer initialized
2025-06-12 17:55:49,160 - anonympdf.anonympdf.feedback_system - INFO - UserFeedbackProcessor initialized
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 17:55:49,160 - anonympdf.anonympdf.feedback_system - INFO - Feedback submitted: false_positive for ADDRESS - {"feedback_id": "integration_test_001", "document_id": "doc_1"}
_______________________________________________________________________ TestGlobalCacheFunctions.test_cache_get_put ________________________________________________________________________
tests\test_intelligent_cache.py:444: in test_cache_get_put
    get_intelligent_cache().clear_all()
app\core\intelligent_cache.py:570: in get_intelligent_cache
    _intelligent_cache = IntelligentCache()
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
___________________________________________________________________ TestGlobalCacheFunctions.test_cache_pattern_function ___________________________________________________________________
tests\test_intelligent_cache.py:453: in test_cache_pattern_function
    get_intelligent_cache().clear_all()
app\core\intelligent_cache.py:570: in get_intelligent_cache
    _intelligent_cache = IntelligentCache()
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
______________________________________________________________ TestGlobalCacheFunctions.test_cache_model_prediction_function _______________________________________________________________
tests\test_intelligent_cache.py:467: in test_cache_model_prediction_function
    get_intelligent_cache().clear_all()
app\core\intelligent_cache.py:570: in get_intelligent_cache
    _intelligent_cache = IntelligentCache()
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
_____________________________________________________________________ TestCacheDecorator.test_function_result_caching ______________________________________________________________________
tests\test_intelligent_cache.py:493: in test_function_result_caching
    get_intelligent_cache().clear_all()
app\core\intelligent_cache.py:570: in get_intelligent_cache
    _intelligent_cache = IntelligentCache()
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
_______________________________________________________________________ TestCacheDecorator.test_custom_key_function ________________________________________________________________________
tests\test_intelligent_cache.py:524: in test_custom_key_function
    get_intelligent_cache().clear_all()
app\core\intelligent_cache.py:570: in get_intelligent_cache
    _intelligent_cache = IntelligentCache()
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
______________________________________________________________________ TestIntegration.test_memory_threshold_handling ______________________________________________________________________
tests\test_memory_optimizer.py:700: in test_memory_threshold_handling
    assert len(high_mem_calls) > 0, "MemoryMonitor should log a warning for high memory usage"
E   AssertionError: MemoryMonitor should log a warning for high memory usage
E   assert 0 > 0
E    +  where 0 = len([])
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:56:10,795 - anonympdf.memory_optimizer - INFO - GarbageCollectionManager initialized
2025-06-12 17:56:10,795 - anonympdf.memory_optimizer - INFO - MemoryMonitor initialized
2025-06-12 17:56:10,795 - anonympdf.memory_optimizer - INFO - MemoryOptimizer initialized. Config: {}
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 17:56:10,810 - anonympdf.memory_optimizer - INFO - MemoryOptimizer.start_optimization() called. Starting memory monitoring.
2025-06-12 17:56:10,857 - anonympdf.memory_optimizer - INFO - Memory monitoring started
2025-06-12 17:56:10,928 - anonympdf.memory_optimizer - INFO - Memory baseline set - {"baseline_mb": 100.0}
--------------------------------------------------------------------------------- Captured stderr teardown ---------------------------------------------------------------------------------
2025-06-12 17:56:11,133 - anonympdf.memory_optimizer - WARNING - High memory usage detected - {"memory_percent": 75.0, "rss_mb": 100.0}
2025-06-12 17:56:11,211 - anonympdf.memory_optimizer - INFO - MemoryOptimizer.stop_optimization() called. Stopping memory monitoring.
2025-06-12 17:56:11,211 - anonympdf.memory_optimizer - WARNING - Critical memory usage detected - {"memory_percent": 92.6, "rss_mb": 2693.74609375}
2025-06-12 17:56:11,224 - anonympdf.memory_optimizer - INFO - Memory monitoring stopped
_______________________________________________________ TestMorningSes5Integration.test_comprehensive_lithuanian_document_processing _______________________________________________________
tests\test_morning_ses5_improvements.py:248: in test_comprehensive_lithuanian_document_processing
    assert len(personal_info["names"]) >= 1, "Should detect STANIULIS TOMAS"
E   KeyError: 'names'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:56:17,712 - anonympdf.pdf - INFO - Initializing PDF processor with Priority 2 enhancements
2025-06-12 17:56:17,728 - config_manager - INFO - Patterns loaded from file - {"file": "config\\patterns.yaml", "patterns_count": 37}
2025-06-12 17:56:17,728 - config_manager - INFO - Cities loaded from file - {"file": "config\\cities.yaml", "cities_count": 79}
2025-06-12 17:56:17,728 - config_manager - INFO - Settings loaded from file - {"file": "config\\settings.yaml"}
2025-06-12 17:56:17,728 - config_manager - INFO - Configuration manager initialized - {"config_dir": "config", "patterns_count": 37, "cities_count": 79}
2025-06-12 17:56:17,728 - anonympdf.pdf - INFO - Configuration manager loaded - {"patterns_count": 37, "cities_count": 79}
2025-06-12 17:56:17,728 - anonympdf.pdf - INFO - Priority 2 context-aware components initialized
2025-06-12 17:56:18,298 - anonympdf.pdf - INFO - English spaCy model loaded successfully - {"model": "en_core_web_sm", "components": 6, "method": "standard"}
2025-06-12 17:56:18,793 - anonympdf.pdf - INFO - Lithuanian spaCy model loaded successfully - {"model": "lt_core_news_sm", "components": 7, "method": "standard"}
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 17:56:18,799 - anonympdf.pdf - INFO - Using Lithuanian NLP model for processing
2025-06-12 17:56:18,831 - anonympdf.pdf - INFO - Detection preserved due to technical term context - {"text": "Vilei\u0161io g. 11-4", "pattern_type": "lithuanian_address_generic", "technical_term": "Maks. variklio galia"}
2025-06-12 17:56:18,831 - anonympdf.pdf - INFO - Detection preserved due to technical term context - {"text": "Adresas: P. Vilei\u0161io g. 11-4", "pattern_type": "lithuanian_address_prefixed", "technical_term": "Maks. variklio galia"}
2025-06-12 17:56:18,831 - anonympdf.performance - INFO - Performance tracking: pii_detection - {"duration": 0.03125882148742676, "memory_delta": -0.79296875, "function": "find_personal_info"}
_________________________________________________________ TestMorningSes5Integration.test_anti_overredaction_in_technical_context __________________________________________________________
tests\test_morning_ses5_improvements.py:284: in test_anti_overredaction_in_technical_context
    assert len(personal_info["names"]) >= 1, "Should detect name"
E   KeyError: 'names'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:56:18,846 - anonympdf.pdf - INFO - Initializing PDF processor with Priority 2 enhancements
2025-06-12 17:56:18,846 - config_manager - INFO - Patterns loaded from file - {"file": "config\\patterns.yaml", "patterns_count": 37}
2025-06-12 17:56:18,862 - config_manager - INFO - Cities loaded from file - {"file": "config\\cities.yaml", "cities_count": 79}
2025-06-12 17:56:18,862 - config_manager - INFO - Settings loaded from file - {"file": "config\\settings.yaml"}
2025-06-12 17:56:18,862 - config_manager - INFO - Configuration manager initialized - {"config_dir": "config", "patterns_count": 37, "cities_count": 79}
2025-06-12 17:56:18,862 - anonympdf.pdf - INFO - Configuration manager loaded - {"patterns_count": 37, "cities_count": 79}
2025-06-12 17:56:18,862 - anonympdf.pdf - INFO - Priority 2 context-aware components initialized
2025-06-12 17:56:19,765 - anonympdf.pdf - INFO - English spaCy model loaded successfully - {"model": "en_core_web_sm", "components": 6, "method": "standard"}
C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\venv\Lib\site-packages\spacy\util.py:910: UserWarning: [W095] Model 'lt_core_news_sm' (3.8.0) was trained with spaCy v3.8.0 and may not be 100% compatible with the current version (3.7.2). If you see errors or degraded performance, download a newer compatible model or retrain your custom model with the current spaCy version. For more details and available updates, run: python -m spacy validate
  warnings.warn(warn_msg)
2025-06-12 17:56:20,545 - anonympdf.pdf - INFO - Lithuanian spaCy model loaded successfully - {"model": "lt_core_news_sm", "components": 7, "method": "standard"}
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 17:56:20,545 - anonympdf.pdf - INFO - Using Lithuanian NLP model for processing
2025-06-12 17:56:20,561 - anonympdf.pdf - INFO - Detection preserved due to technical term context - {"text": "38901234567", "pattern_type": "eleven_digit_numeric", "technical_term": "kW"}
2025-06-12 17:56:20,561 - anonympdf.pdf - INFO - Detection preserved due to technical term context - {"text": "38901234567", "pattern_type": "health_insurance_number", "technical_term": "kW"}
2025-06-12 17:56:20,567 - anonympdf.pdf - INFO - Detection preserved due to technical term context - {"text": "38901234567", "pattern_type": "lithuanian_personal_code", "technical_term": "kW"}
2025-06-12 17:56:20,567 - anonympdf.pdf - INFO - Detection preserved due to technical term context - {"text": "asmens kodas: 38901234567", "pattern_type": "lithuanian_personal_code_contextual", "technical_term": "kW"}
2025-06-12 17:56:20,567 - anonympdf.performance - INFO - Performance tracking: pii_detection - {"duration": 0.02213144302368164, "memory_delta": 0.08203125, "function": "find_personal_info"}
_________________________________________________________________________________ test_find_personal_info __________________________________________________________________________________
tests\test_pdf_processor.py:48: in test_find_personal_info
    personal_info = configured_pdf_processor.find_personal_info(sample_text, language="en")
app\core\performance.py:576: in wrapper
    result = func(*args, **kwargs)
app\services\pdf_processor.py:339: in find_personal_info
    matches = re.finditer(current_regex_text, text)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\re\__init__.py:223: in finditer
    return _compile(pattern, flags).finditer(string)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\re\__init__.py:277: in _compile
    return _cache[type(pattern), pattern, flags]
E   TypeError: unhashable type: 'list'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:56:23,120 - anonympdf.pdf - INFO - Initializing PDF processor with Priority 2 enhancements
2025-06-12 17:56:23,120 - config_manager - INFO - Patterns loaded from file - {"file": "config\\patterns.yaml", "patterns_count": 37}
2025-06-12 17:56:23,136 - config_manager - INFO - Cities loaded from file - {"file": "config\\cities.yaml", "cities_count": 79}
2025-06-12 17:56:23,136 - config_manager - INFO - Settings loaded from file - {"file": "config\\settings.yaml"}
2025-06-12 17:56:23,136 - config_manager - INFO - Configuration manager initialized - {"config_dir": "config", "patterns_count": 37, "cities_count": 79}
2025-06-12 17:56:23,136 - anonympdf.pdf - INFO - Configuration manager loaded - {"patterns_count": 37, "cities_count": 79}
2025-06-12 17:56:23,136 - anonympdf.pdf - INFO - Priority 2 context-aware components initialized
2025-06-12 17:56:23,753 - anonympdf.pdf - INFO - English spaCy model loaded successfully - {"model": "en_core_web_sm", "components": 6, "method": "standard"}
2025-06-12 17:56:24,223 - anonympdf.pdf - INFO - Lithuanian spaCy model loaded successfully - {"model": "lt_core_news_sm", "components": 7, "method": "standard"}
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 17:56:24,223 - anonympdf.pdf - INFO - Using English NLP model for processing - {"language": "en"}
2025-06-12 17:56:24,238 - anonympdf.performance - INFO - Performance tracking: pii_detection - {"duration": 0.0156557559967041, "memory_delta": 0.53515625, "function": "find_personal_info"}
______________________________________________________________________________ test_generate_redaction_report ______________________________________________________________________________
tests\test_pdf_processor.py:59: in test_generate_redaction_report
    personal_info = configured_pdf_processor.find_personal_info(sample_text, language="en")
app\core\performance.py:576: in wrapper
    result = func(*args, **kwargs)
app\services\pdf_processor.py:339: in find_personal_info
    matches = re.finditer(current_regex_text, text)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\re\__init__.py:223: in finditer
    return _compile(pattern, flags).finditer(string)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\re\__init__.py:277: in _compile
    return _cache[type(pattern), pattern, flags]
E   TypeError: unhashable type: 'list'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:56:24,755 - anonympdf.pdf - INFO - Initializing PDF processor with Priority 2 enhancements
2025-06-12 17:56:24,755 - config_manager - INFO - Patterns loaded from file - {"file": "config\\patterns.yaml", "patterns_count": 37}
2025-06-12 17:56:24,770 - config_manager - INFO - Cities loaded from file - {"file": "config\\cities.yaml", "cities_count": 79}
2025-06-12 17:56:24,777 - config_manager - INFO - Settings loaded from file - {"file": "config\\settings.yaml"}
2025-06-12 17:56:24,777 - config_manager - INFO - Configuration manager initialized - {"config_dir": "config", "patterns_count": 37, "cities_count": 79}
2025-06-12 17:56:24,777 - anonympdf.pdf - INFO - Configuration manager loaded - {"patterns_count": 37, "cities_count": 79}
2025-06-12 17:56:24,777 - anonympdf.pdf - INFO - Priority 2 context-aware components initialized
2025-06-12 17:56:25,294 - anonympdf.pdf - INFO - English spaCy model loaded successfully - {"model": "en_core_web_sm", "components": 6, "method": "standard"}
C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\venv\Lib\site-packages\spacy\util.py:910: UserWarning: [W095] Model 'lt_core_news_sm' (3.8.0) was trained with spaCy v3.8.0 and may not be 100% compatible with the current version (3.7.2). If you see errors or degraded performance, download a newer compatible model or retrain your custom model with the current spaCy version. For more details and available updates, run: python -m spacy validate
  warnings.warn(warn_msg)
2025-06-12 17:56:25,758 - anonympdf.pdf - INFO - Lithuanian spaCy model loaded successfully - {"model": "lt_core_news_sm", "components": 7, "method": "standard"}
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 17:56:25,758 - anonympdf.pdf - INFO - Using English NLP model for processing - {"language": "en"}
2025-06-12 17:56:25,758 - anonympdf.performance - INFO - Performance tracking: pii_detection - {"duration": 0.0, "memory_delta": 0.3671875, "function": "find_personal_info"}
__________________________________________________________________ TestPerformanceIntegration.test_get_performance_report __________________________________________________________________
tests\test_performance.py:214: in test_get_performance_report
    report = get_performance_report()
app\core\performance.py:623: in get_performance_report
    report["performance_optimizer_stats"] = get_performance_stats()
app\core\performance_optimizer.py:897: in get_performance_stats
    return get_performance_optimizer().get_optimization_stats()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 17:56:27,695 - anonympdf.performance - INFO - Performance tracking: integration_test - {"duration": 0.05836153030395508, "memory_delta": 0.0}
_____________________________________________________________________ TestGlobalFunctions.test_get_performance_report ______________________________________________________________________
tests\test_performance_enhanced.py:470: in test_get_performance_report
    with global_performance_monitor.track_operation("global_op") as tracker:
E   TypeError: 'dict' object does not support the context manager protocol
_____________________________________________________________________ TestGlobalFunctions.test_get_parallel_processor ______________________________________________________________________
tests\test_performance_enhanced.py:480: in test_get_parallel_processor
    processor = get_parallel_processor()
app\core\performance.py:635: in get_parallel_processor
    return get_optimized_processor()
app\core\performance.py:605: in get_optimized_processor
    _optimized_processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
_______________________________________________________________ TestGlobalFunctions.test_performance_report_with_optimizers ________________________________________________________________
tests\test_performance_enhanced.py:485: in test_performance_report_with_optimizers
    processor = get_optimized_processor() # No longer takes config
app\core\performance.py:605: in get_optimized_processor
    _optimized_processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
___________________________________________________________________ TestIntegration.test_end_to_end_parallel_processing ____________________________________________________________________
tests\test_performance_enhanced.py:495: in test_end_to_end_parallel_processing
    processor = get_optimized_processor() # No longer takes config
app\core\performance.py:605: in get_optimized_processor
    _optimized_processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
____________________________________________________________________ TestIntegration.test_concurrent_metric_collection _____________________________________________________________________
tests\test_performance_enhanced.py:521: in test_concurrent_metric_collection
    processor = get_optimized_processor() # No longer takes config
app\core\performance.py:605: in get_optimized_processor
    _optimized_processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
_______________________________________________________________________ TestIntegration.test_performance_under_load ________________________________________________________________________
tests\test_performance_enhanced.py:543: in test_performance_under_load
    processor = get_optimized_processor() # No longer takes config
app\core\performance.py:605: in get_optimized_processor
    _optimized_processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
_____________________________________________________________________ TestGlobalInstances.test_get_parallel_processor ______________________________________________________________________
tests\test_performance_optimizer.py:334: in test_get_parallel_processor
    processor = get_parallel_processor()
app\core\performance_optimizer.py:642: in get_parallel_processor
    _parallel_processor = ParallelProcessor(config=config.get('parallel_processing', {}))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
________________________________________________________________________ TestGlobalInstances.test_get_batch_engine _________________________________________________________________________
tests\test_performance_optimizer.py:341: in test_get_batch_engine
    engine = get_batch_engine()
app\core\performance_optimizer.py:651: in get_batch_engine
    _batch_engine = BatchEngine(config=config)
app\core\performance_optimizer.py:523: in __init__
    self.config = config or get_config()['performance']
E   KeyError: 'performance'
________________________________________________________________________ TestIntegration.test_end_to_end_processing ________________________________________________________________________
tests\test_performance_optimizer.py:350: in test_end_to_end_processing
    engine = BatchEngine()
app\core\performance_optimizer.py:523: in __init__
    self.config = config or get_config()['performance']
E   KeyError: 'performance'
_________________________________________________________________ TestIntegration.test_performance_improvement_simulation __________________________________________________________________
tests\test_performance_optimizer.py:368: in test_performance_improvement_simulation
    processor = ParallelProcessor()
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
___________________________________________________________________ TestAnomalyDetector.test_alert_threshold_integration ___________________________________________________________________
tests\test_real_time_monitor.py:156: in test_alert_threshold_integration
    assert len(anomalies) > 0
E   assert 0 > 0
E    +  where 0 = len([])
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:56:30,069 - anonympdf.anonympdf.real_time_monitor - INFO - AnomalyDetector initialized with sensitivity: medium, alert_thresholds: 0
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 17:56:30,069 - anonympdf.anonympdf.real_time_monitor - INFO - Added alert threshold for test_metric
________________________________________________________________ TestRealTimeMonitor.test_ml_monitor_callback_functionality ________________________________________________________________
tests\test_real_time_monitor.py:353: in test_ml_monitor_callback_functionality
    assert mock_system.call_count == 1
E   AssertionError: assert 0 == 1
E    +  where 0 = <MagicMock name='get_system_metrics' id='2958532542672'>.call_count
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:56:30,269 - anonympdf.anonympdf.real_time_monitor - INFO - AnomalyDetector initialized with sensitivity: medium, alert_thresholds: 0
2025-06-12 17:56:30,269 - anonympdf.anonympdf.real_time_monitor - INFO - PerformanceAggregator initialized
2025-06-12 17:56:30,307 - anonympdf.anonympdf.real_time_monitor - INFO - RealTimeMonitor initialized
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 17:56:30,307 - anonympdf.anonympdf.real_time_monitor - INFO - Registered as ML metrics callback for automatic forwarding
______________________________________________________________________ TestRealTimeMonitor.test_alert_callback_system ______________________________________________________________________
tests\test_real_time_monitor.py:452: in test_alert_callback_system
    self.monitor._process_anomaly_alerts([mock_anomaly])
app\core\real_time_monitor.py:670: in _process_anomaly_alerts
    self._store_anomaly(anomaly)
app\core\real_time_monitor.py:709: in _store_anomaly
    json.dumps(anomaly.context)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\json\__init__.py:231: in dumps
    return _default_encoder.encode(obj)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\json\encoder.py:200: in encode
    chunks = self.iterencode(o, _one_shot=True)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\json\encoder.py:258: in iterencode
    return _iterencode(o, 0)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\json\encoder.py:180: in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
E   TypeError: Object of type Mock is not JSON serializable
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:56:31,527 - anonympdf.anonympdf.real_time_monitor - INFO - AnomalyDetector initialized with sensitivity: medium, alert_thresholds: 0
2025-06-12 17:56:31,527 - anonympdf.anonympdf.real_time_monitor - INFO - PerformanceAggregator initialized
2025-06-12 17:56:31,596 - anonympdf.anonympdf.real_time_monitor - INFO - RealTimeMonitor initialized
_______________________________________________________________ TestTrainingDataStorage.test_save_and_load_training_examples _______________________________________________________________
tests\test_training_data_collector.py:89: in test_save_and_load_training_examples
    create_dummy_example("123 Main St", "ADDRESS", True, "doc1", source="test_source_1"),
E   TypeError: create_dummy_example() got an unexpected keyword argument 'source'
___________________________________________________________________ TestTrainingDataStorage.test_get_dataset_stats_empty ___________________________________________________________________
tests\test_training_data_collector.py:126: in test_get_dataset_stats_empty
    assert stats.total_samples == 0
E   AttributeError: 'NoneType' object has no attribute 'total_samples'
____________________________________________________________ TestTrainingDataCollector.test_get_balanced_training_set_with_data ____________________________________________________________
tests\test_training_data_collector.py:213: in test_get_balanced_training_set_with_data
    assert stats.total_samples == 13
E   assert 6 == 13
E    +  where 6 = DatasetStats(total_samples=6, positive_samples=3, negative_samples=3, categories={}, document_types={}, date_range=(datetime.datetime(2025, 6, 12, 17, 56, 43, 409360), datetime.datetime(2025, 6, 12, 17, 56, 43, 409360)), quality_score=1.0).total_samples
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 17:56:43,409 - anonympdf.app.core.training_data - INFO - Created balanced training set: 6 examples
_____________________________________________________________________ TestPersonNameValidation.test_length_validation ______________________________________________________________________
tests\test_validation_utils.py:58: in test_length_validation
    assert not validate_person_name("This Is A Very Long Name That Should Be Rejected")
E   AssertionError: assert not True
E    +  where True = validate_person_name('This Is A Very Long Name That Should Be Rejected')
_____________________________________________________________ TestABTestManager.test_record_and_evaluate_metrics_variant_wins ______________________________________________________________
tests\adaptive\test_ab_testing.py:112: in test_record_and_evaluate_metrics_variant_wins
    self.assertEqual(result.metrics_comparison['accuracy']['winner'], 'variant')
E   KeyError: 'winner'
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 17:56:43,710 - anonympdf.ab_testing - INFO - Loading A/B tests from database.
2025-06-12 17:56:43,710 - anonympdf.ab_testing - INFO - Loaded 0 tests.
2025-06-12 17:56:43,710 - anonympdf.ab_testing - INFO - ABTestManager initialized with database at test_ab_manager.db.
2025-06-12 17:56:43,710 - anonympdf.ab_testing - INFO - Saving test ab_5a746e41 to database.
2025-06-12 17:56:43,710 - anonympdf.ab_testing - INFO - Created new A/B test 'Evaluation Test' with ID ab_5a746e41.
2025-06-12 17:56:43,710 - anonympdf.ab_testing - INFO - Saving test ab_5a746e41 to database.
2025-06-12 17:56:43,725 - anonympdf.ab_testing - INFO - Started A/B test 'Evaluation Test' (ID: ab_5a746e41).
C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\venv\Lib\site-packages\scipy\stats\_axis_nan_policy.py:586: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  res = hypotest_fun_out(*samples, **kwds)
2025-06-12 17:56:44,195 - anonympdf.ab_testing - INFO - Database connection to test_ab_manager.db closed.
_______________________________________________________ TestOnlineLearner.test_retrain_model_saves_examples_and_triggers_retraining ________________________________________________________
tests\adaptive\test_online_learner.py:123: in test_retrain_model_saves_examples_and_triggers_retraining
    online_learner.retrain_model(sample_training_examples)
E   AttributeError: 'OnlineLearner' object has no attribute 'retrain_model'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:56:44,797 - anonympdf.adaptive_learning.online_learner - INFO - OnlineLearner initialized.
_________________________________________________________ TestOnlineLearner.test_retrain_model_saves_examples_but_skips_retraining _________________________________________________________
tests\adaptive\test_online_learner.py:134: in test_retrain_model_saves_examples_but_skips_retraining
    online_learner.retrain_model(sample_training_examples)
E   AttributeError: 'OnlineLearner' object has no attribute 'retrain_model'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:56:44,812 - anonympdf.adaptive_learning.online_learner - INFO - OnlineLearner initialized.
__________________________________________________________________ TestPatternLearner.test_discover_and_validate_patterns __________________________________________________________________
tests\adaptive\test_pattern_learner.py:39: in test_discover_and_validate_patterns
    assert len(patterns) == 1
E   assert 0 == 1
E    +  where 0 = len([])
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 17:56:44,997 - anonympdf.app.core.adaptive.pattern_learner - INFO - PatternLearner initialized - {"min_confidence": 0.8, "min_samples": 3}
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 17:56:44,997 - anonympdf.app.core.adaptive.pattern_learner - WARNING - Insufficient samples for pattern discovery. Need 3, got 1
=================================================================================== slowest 10 durations ===================================================================================
19.15s setup    tests/test_feedback_system.py::TestUserFeedbackProcessor::test_get_feedback_stats
17.51s setup    tests/test_feedback_system.py::TestFeedbackSystemIntegration::test_config_integration
16.01s setup    tests/test_feedback_system.py::TestUserFeedbackProcessor::test_submit_feedback
12.82s setup    tests/test_feedback_system.py::TestUserFeedbackProcessor::test_should_trigger_retrain_threshold
12.19s setup    tests/test_feedback_system.py::TestUserFeedbackProcessor::test_process_pending_feedback
12.05s setup    tests/test_feedback_system.py::TestFeedbackSystemIntegration::test_feedback_submission_and_processing_flow
8.07s setup    tests/test_feedback_system.py::TestUserFeedbackProcessor::test_validate_feedback_invalid
7.38s setup    tests/test_feedback_system.py::TestFeedbackSystemIntegration::test_concurrent_feedback_submission
7.35s setup    tests/test_feedback_system.py::TestUserFeedbackProcessor::test_should_trigger_retrain_time
7.11s setup    tests/test_feedback_system.py::TestUserFeedbackProcessor::test_feedback_to_training_example_false_negative
================================================================================= short test summary info ==================================================================================
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_initialization - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_add_detection_result - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_add_detection_result_with_ground_truth - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_analyze_detection_quality_empty - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_analyze_detection_quality_single_category - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_analyze_detection_quality_multiple_categories - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_analyze_detection_quality_with_document_type_filter - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_analyze_detection_quality_with_ground_truth - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_detect_quality_issues_low_confidence - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_detect_quality_issues_performance_degradation - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_detect_quality_issues_high_false_positive - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_quality_report_empty - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_quality_report_with_data - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_improvement_suggestions_no_issues - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_improvement_suggestions_with_issues - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_storage_integration - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_quality_trends_insufficient_data - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_quality_trends_valid_metric - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_quality_trends_declining - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_quality_trends_invalid_metric - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_thread_safety - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_config_integration - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_ml_integration_compatibility - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityAnalyzer::test_performance_impact - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_pattern_insights_empty - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_pattern_insights_with_data - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_model_insights_insufficient_data - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_model_insights_excellent_model - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_model_insights_needs_improvement - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_report_with_data - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestAnalyticsEngineIntegration::test_engine_initialization - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_analytics_engine.py::TestAnalyticsEngineIntegration::test_full_analysis_workflow - TypeError: StructuredLogger.info() takes 2 positional arguments but 3 were given
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerFeedback::test_add_user_feedback_confirmed_correct - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerFeedback::test_add_user_feedback_false_positive - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerFeedback::test_add_user_feedback_category_correction - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerFeedback::test_add_user_feedback_context_details - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerFeedback::test_add_user_feedback_handles_uuid - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerFeedback::test_add_user_feedback_handles_user_feedback_system_failure - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerDetectionProcessing::test_detect_with_ml_integration_calls_quality_analyzer - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerDetectionProcessing::test_detect_with_ml_integration_calls_quality_analyzer_on_fallback - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLConfidenceScorerIntegration::test_adaptive_pattern_overrides_ml_model - NameError: name 'Mock' is not defined
ERROR tests/test_performance_enhanced.py::TestPerformanceOptimizedProcessor::test_processor_initialization - KeyError: 'performance'
ERROR tests/test_performance_enhanced.py::TestPerformanceOptimizedProcessor::test_optimized_processing_session - KeyError: 'performance'
ERROR tests/test_performance_enhanced.py::TestPerformanceOptimizedProcessor::test_parallel_file_processing - KeyError: 'performance'
ERROR tests/test_performance_enhanced.py::TestPerformanceOptimizedProcessor::test_empty_files_processing - KeyError: 'performance'
ERROR tests/test_performance_enhanced.py::TestPerformanceOptimizedProcessor::test_single_file_processing_with_caching - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestParallelProcessor::test_determine_processing_mode - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestParallelProcessor::test_process_single_document - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestParallelProcessor::test_process_batch_sequential - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestParallelProcessor::test_process_batch_parallel_threads - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestParallelProcessor::test_execute_task - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestParallelProcessor::test_execute_task_with_error - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestBatchEngine::test_submit_batch - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestBatchEngine::test_process_next_batch - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestBatchEngine::test_get_queue_stats - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestBatchEngine::test_process_empty_queue - KeyError: 'performance'
ERROR tests/test_training_data_collector.py::TestTrainingDataStorage::test_storage_initialization - PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpmh2fx1h7\\training_data.db'
ERROR tests/adaptive/test_coordinator.py::test_initialization - AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the ...
ERROR tests/adaptive/test_coordinator.py::test_process_feedback_and_learn_cycle - AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the ...
ERROR tests/adaptive/test_coordinator.py::test_process_feedback_with_no_new_pii - AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the ...
ERROR tests/adaptive/test_coordinator.py::test_ab_testing_integration - AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the ...
ERROR tests/adaptive/test_coordinator.py::test_evaluate_and_log_ab_test - AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the ...
ERROR tests/adaptive/test_coordinator.py::test_close_method - AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the ...
ERROR tests/system/test_adaptive_workflow.py::test_fixture_creation - TypeError: QualityAnalyzer.__init__() got an unexpected keyword argument 'storage_path'
ERROR tests/system/test_adaptive_workflow.py::test_feedback_creates_pattern_and_overrides_prediction - TypeError: QualityAnalyzer.__init__() got an unexpected keyword argument 'storage_path'
ERROR tests/system/test_adaptive_workflow.py::test_ab_testing_full_lifecycle - TypeError: QualityAnalyzer.__init__() got an unexpected keyword argument 'storage_path'
FAILED tests/test_analytics_api.py::TestAnalyticsEndpoints::test_get_anomaly_history_with_filters - assert 500 == 200
FAILED tests/test_config_manager.py::TestConfigManager::test_configuration_validation - assert False is True
FAILED tests/test_feedback_system.py::TestFeedbackSystemIntegration::test_feedback_submission_and_processing_flow - AttributeError: <app.core.training_data.TrainingDataCollector object at 0x000002B0B1097DD0> does not have the attribute 'save_training_examples'
FAILED tests/test_intelligent_cache.py::TestGlobalCacheFunctions::test_cache_get_put - KeyError: 'performance'
FAILED tests/test_intelligent_cache.py::TestGlobalCacheFunctions::test_cache_pattern_function - KeyError: 'performance'
FAILED tests/test_intelligent_cache.py::TestGlobalCacheFunctions::test_cache_model_prediction_function - KeyError: 'performance'
FAILED tests/test_intelligent_cache.py::TestCacheDecorator::test_function_result_caching - KeyError: 'performance'
FAILED tests/test_intelligent_cache.py::TestCacheDecorator::test_custom_key_function - KeyError: 'performance'
FAILED tests/test_memory_optimizer.py::TestIntegration::test_memory_threshold_handling - AssertionError: MemoryMonitor should log a warning for high memory usage
FAILED tests/test_morning_ses5_improvements.py::TestMorningSes5Integration::test_comprehensive_lithuanian_document_processing - KeyError: 'names'
FAILED tests/test_morning_ses5_improvements.py::TestMorningSes5Integration::test_anti_overredaction_in_technical_context - KeyError: 'names'
FAILED tests/test_pdf_processor.py::test_find_personal_info - TypeError: unhashable type: 'list'
FAILED tests/test_pdf_processor.py::test_generate_redaction_report - TypeError: unhashable type: 'list'
FAILED tests/test_performance.py::TestPerformanceIntegration::test_get_performance_report - KeyError: 'performance'
FAILED tests/test_performance_enhanced.py::TestGlobalFunctions::test_get_performance_report - TypeError: 'dict' object does not support the context manager protocol
FAILED tests/test_performance_enhanced.py::TestGlobalFunctions::test_get_parallel_processor - KeyError: 'performance'
FAILED tests/test_performance_enhanced.py::TestGlobalFunctions::test_performance_report_with_optimizers - KeyError: 'performance'
FAILED tests/test_performance_enhanced.py::TestIntegration::test_end_to_end_parallel_processing - KeyError: 'performance'
FAILED tests/test_performance_enhanced.py::TestIntegration::test_concurrent_metric_collection - KeyError: 'performance'
FAILED tests/test_performance_enhanced.py::TestIntegration::test_performance_under_load - KeyError: 'performance'
FAILED tests/test_performance_optimizer.py::TestGlobalInstances::test_get_parallel_processor - KeyError: 'performance'
FAILED tests/test_performance_optimizer.py::TestGlobalInstances::test_get_batch_engine - KeyError: 'performance'
FAILED tests/test_performance_optimizer.py::TestIntegration::test_end_to_end_processing - KeyError: 'performance'
FAILED tests/test_performance_optimizer.py::TestIntegration::test_performance_improvement_simulation - KeyError: 'performance'
FAILED tests/test_real_time_monitor.py::TestAnomalyDetector::test_alert_threshold_integration - assert 0 > 0
FAILED tests/test_real_time_monitor.py::TestRealTimeMonitor::test_ml_monitor_callback_functionality - AssertionError: assert 0 == 1
FAILED tests/test_real_time_monitor.py::TestRealTimeMonitor::test_alert_callback_system - TypeError: Object of type Mock is not JSON serializable
FAILED tests/test_training_data_collector.py::TestTrainingDataStorage::test_save_and_load_training_examples - TypeError: create_dummy_example() got an unexpected keyword argument 'source'
FAILED tests/test_training_data_collector.py::TestTrainingDataStorage::test_get_dataset_stats_empty - AttributeError: 'NoneType' object has no attribute 'total_samples'
FAILED tests/test_training_data_collector.py::TestTrainingDataCollector::test_get_balanced_training_set_with_data - assert 6 == 13
FAILED tests/test_validation_utils.py::TestPersonNameValidation::test_length_validation - AssertionError: assert not True
FAILED tests/adaptive/test_ab_testing.py::TestABTestManager::test_record_and_evaluate_metrics_variant_wins - KeyError: 'winner'
FAILED tests/adaptive/test_online_learner.py::TestOnlineLearner::test_retrain_model_saves_examples_and_triggers_retraining - AttributeError: 'OnlineLearner' object has no attribute 'retrain_model'
FAILED tests/adaptive/test_online_learner.py::TestOnlineLearner::test_retrain_model_saves_examples_but_skips_retraining - AttributeError: 'OnlineLearner' object has no attribute 'retrain_model'
FAILED tests/adaptive/test_pattern_learner.py::TestPatternLearner::test_discover_and_validate_patterns - assert 0 == 1
================================================================== 35 failed, 286 passed, 66 errors in 206.77s (0:03:26) ===================================================================
(venv) PS C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF>