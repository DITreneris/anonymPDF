(venv) PS C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF> pytest
=================================================================================== test session starts ====================================================================================
platform win32 -- Python 3.11.9, pytest-7.4.3, pluggy-1.6.0
benchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF
configfile: pytest.ini
testpaths: tests
plugins: anyio-3.7.1, hypothesis-6.92.1, asyncio-0.21.1, benchmark-4.0.0, cov-4.1.0, mock-3.12.0
asyncio: mode=Mode.STRICT
collected 386 items

tests\test_analytics_api.py .......................                                                                                                                                   [  5%]
tests\test_analytics_engine.py .FF.FFFFFFFFFFFFFFFFC:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\venv\Lib\site-packages\_pytest\threadexception.py:73: PytestUnhandledThreadExceptionWarning: Exception in thread Thread-3 (add_results)

Traceback (most recent call last):
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\tests\test_analytics_engine.py", line 423, in add_results
    self.analyzer.add_detection_result(result)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'

  warnings.warn(pytest.PytestUnhandledThreadExceptionWarning(msg))
FFFFFEFEFEFEFEFE.F                                                                                                                 [ 14%]
tests\test_config_manager.py ...F.........                                                                                                                                            [ 17%]
tests\test_feedback_system.py ...................F.                                                                                                                                   [ 23%]
tests\test_intelligent_cache.py .................EEEEEEEEEFFE                                                                                                                         [ 30%]
tests\test_memory_optimizer.py ..............................F                                                                                                                        [ 38%]
tests\test_ml_integration_layer.py EEEEEEEEE                                                                                                                                          [ 40%]
tests\test_morning_ses5_improvements.py FFFFFFFEEEEEFF                                                                                                                                [ 44%]
tests\test_pdf_processor.py .FFF                                                                                                                                                      [ 45%]
tests\test_performance.py ............F.                                                                                                                                              [ 49%]
tests\test_performance_enhanced.py .............EEEEE....FFFFFF                                                                                                                       [ 56%]
tests\test_performance_optimizer.py ....EEEEEEEEEE...FFFF                                                                                                                             [ 61%]
tests\test_pii_patterns.py .............                                                                                                                                              [ 65%]
tests\test_priority2_enhancements.py .............................                                                                                                                    [ 72%]
tests\test_real_time_monitor.py .........F........F....F.......                                                                                                                       [ 80%]
tests\test_training_data_collector.py .EFF.....F                                                                                                                                      [ 83%]
tests\test_validation_utils.py ...F..................                                                                                                                                 [ 88%]
tests\adaptive\test_ab_testing.py ......F.                                                                                                                                            [ 90%]
tests\adaptive\test_coordinator.py EEEEEE                                                                                                                                             [ 92%]
tests\adaptive\test_doc_classifier.py ........                                                                                                                                        [ 94%]
tests\adaptive\test_online_learner.py ....FF                                                                                                                                          [ 96%]
tests\adaptive\test_pattern_db.py ......                                                                                                                                              [ 97%]
tests\adaptive\test_pattern_learner.py .F                                                                                                                                             [ 98%]
tests\adaptive\test_processing_rules.py ....                                                                                                                                          [ 99%]
tests\system\test_adaptive_workflow.py EEE                                                                                                                                            [100%]

========================================================================================== ERRORS ==========================================================================================
__________________________________________________ ERROR at teardown of TestQualityInsightsGenerator.test_generate_pattern_insights_empty __________________________________________________
tests\test_analytics_engine.py:531: in teardown_method
    shutil.rmtree(self.temp_dir)
E   NameError: name 'shutil' is not defined
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:26,842 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:26,843 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpbc6y5mlq\\test_insights.db"}}
________________________________________________ ERROR at teardown of TestQualityInsightsGenerator.test_generate_pattern_insights_with_data ________________________________________________
tests\test_analytics_engine.py:531: in teardown_method
    shutil.rmtree(self.temp_dir)
E   NameError: name 'shutil' is not defined
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:27,084 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:27,084 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpa70r4o8a\\test_insights.db"}}
_____________________________________________ ERROR at teardown of TestQualityInsightsGenerator.test_generate_model_insights_insufficient_data _____________________________________________
tests\test_analytics_engine.py:531: in teardown_method
    shutil.rmtree(self.temp_dir)
E   NameError: name 'shutil' is not defined
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:27,158 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:27,159 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpa2s20nle\\test_insights.db"}}
______________________________________________ ERROR at teardown of TestQualityInsightsGenerator.test_generate_model_insights_excellent_model ______________________________________________
tests\test_analytics_engine.py:531: in teardown_method
    shutil.rmtree(self.temp_dir)
E   NameError: name 'shutil' is not defined
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:27,239 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:27,240 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmphw6bifs5\\test_insights.db"}}
_____________________________________________ ERROR at teardown of TestQualityInsightsGenerator.test_generate_model_insights_needs_improvement _____________________________________________
tests\test_analytics_engine.py:531: in teardown_method
    shutil.rmtree(self.temp_dir)
E   NameError: name 'shutil' is not defined
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:27,315 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:27,316 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmp_2d1k248\\test_insights.db"}}
_____________________________________________________ ERROR at teardown of TestQualityInsightsGenerator.test_generate_report_with_data _____________________________________________________
tests\test_analytics_engine.py:531: in teardown_method
    shutil.rmtree(self.temp_dir)
E   NameError: name 'shutil' is not defined
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:27,392 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:27,393 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpt9epmcnm\\test_insights.db"}}
___________________________________________________________ ERROR at setup of TestIntelligentCache.test_general_cache_operations ___________________________________________________________
tests\test_intelligent_cache.py:330: in setup_method
    self.cache = get_intelligent_cache()
app\core\intelligent_cache.py:577: in get_intelligent_cache
    instance = IntelligentCache(config=config)
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
__________________________________________________________ ERROR at setup of TestIntelligentCache.test_pattern_cache_integration ___________________________________________________________
tests\test_intelligent_cache.py:330: in setup_method
    self.cache = get_intelligent_cache()
app\core\intelligent_cache.py:577: in get_intelligent_cache
    instance = IntelligentCache(config=config)
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
___________________________________________________________ ERROR at setup of TestIntelligentCache.test_model_cache_integration ____________________________________________________________
tests\test_intelligent_cache.py:330: in setup_method
    self.cache = get_intelligent_cache()
app\core\intelligent_cache.py:577: in get_intelligent_cache
    instance = IntelligentCache(config=config)
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
_____________________________________________________________ ERROR at setup of TestIntelligentCache.test_comprehensive_stats ______________________________________________________________
tests\test_intelligent_cache.py:330: in setup_method
    self.cache = get_intelligent_cache()
app\core\intelligent_cache.py:577: in get_intelligent_cache
    instance = IntelligentCache(config=config)
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
________________________________________________________________ ERROR at setup of TestIntelligentCache.test_cache_cleanup _________________________________________________________________
tests\test_intelligent_cache.py:330: in setup_method
    self.cache = get_intelligent_cache()
app\core\intelligent_cache.py:577: in get_intelligent_cache
    instance = IntelligentCache(config=config)
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
_______________________________________________________________ ERROR at setup of TestIntelligentCache.test_clear_all_caches _______________________________________________________________
tests\test_intelligent_cache.py:330: in setup_method
    self.cache = get_intelligent_cache()
app\core\intelligent_cache.py:577: in get_intelligent_cache
    instance = IntelligentCache(config=config)
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
______________________________________________________________ ERROR at setup of TestGlobalCacheFunctions.test_cache_get_put _______________________________________________________________
tests\test_intelligent_cache.py:441: in setup_method
    get_intelligent_cache().clear_all()
app\core\intelligent_cache.py:577: in get_intelligent_cache
    instance = IntelligentCache(config=config)
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
__________________________________________________________ ERROR at setup of TestGlobalCacheFunctions.test_cache_pattern_function __________________________________________________________
tests\test_intelligent_cache.py:441: in setup_method
    get_intelligent_cache().clear_all()
app\core\intelligent_cache.py:577: in get_intelligent_cache
    instance = IntelligentCache(config=config)
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
_____________________________________________________ ERROR at setup of TestGlobalCacheFunctions.test_cache_model_prediction_function ______________________________________________________
tests\test_intelligent_cache.py:441: in setup_method
    get_intelligent_cache().clear_all()
app\core\intelligent_cache.py:577: in get_intelligent_cache
    instance = IntelligentCache(config=config)
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
___________________________________________________________________ ERROR at setup of TestConcurrency.test_thread_safety ___________________________________________________________________
tests\test_intelligent_cache.py:538: in setup_method
    get_intelligent_cache().clear_all()
app\core\intelligent_cache.py:577: in get_intelligent_cache
    instance = IntelligentCache(config=config)
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
________________________________________________ ERROR at setup of TestMLIntegrationLayerFeedback.test_add_user_feedback_confirmed_correct _________________________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
__________________________________________________ ERROR at setup of TestMLIntegrationLayerFeedback.test_add_user_feedback_false_positive __________________________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
_______________________________________________ ERROR at setup of TestMLIntegrationLayerFeedback.test_add_user_feedback_category_correction ________________________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
_________________________________________________ ERROR at setup of TestMLIntegrationLayerFeedback.test_add_user_feedback_context_details __________________________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
___________________________________________________ ERROR at setup of TestMLIntegrationLayerFeedback.test_add_user_feedback_handles_uuid ___________________________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
_______________________________________ ERROR at setup of TestMLIntegrationLayerFeedback.test_add_user_feedback_handles_user_feedback_system_failure _______________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
____________________________________ ERROR at setup of TestMLIntegrationLayerDetectionProcessing.test_detect_with_ml_integration_calls_quality_analyzer ____________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
______________________________ ERROR at setup of TestMLIntegrationLayerDetectionProcessing.test_detect_with_ml_integration_calls_quality_analyzer_on_fallback ______________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
_______________________________________________ ERROR at setup of TestMLConfidenceScorerIntegration.test_adaptive_pattern_overrides_ml_model _______________________________________________
tests\test_ml_integration_layer.py:46: in mock_dependencies
    mock_scorer.return_value = Mock(spec=MLConfidenceScorer)
E   NameError: name 'Mock' is not defined
________________________________________________ ERROR at setup of TestMorningSes5AntiOverredaction.test_preserve_detection_technical_terms ________________________________________________
tests\test_morning_ses5_improvements.py:156: in pdf_processor_with_test_config
    processor.config['anti_overredaction'] = {
E   AttributeError: 'PDFProcessor' object has no attribute 'config'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:32:20,862 - anonympdf.pdf - INFO - Initializing PDF processor with Priority 2 enhancements
2025-06-12 18:32:20,868 - config_manager - INFO - Patterns loaded from file - {"file": "config\\patterns.yaml", "patterns_count": 37}
2025-06-12 18:32:20,873 - config_manager - INFO - Cities loaded from file - {"file": "config\\cities.yaml", "cities_count": 79}
2025-06-12 18:32:20,879 - config_manager - INFO - Settings loaded from file - {"file": "config\\settings.yaml"}
2025-06-12 18:32:20,879 - config_manager - INFO - Configuration manager initialized - {"config_dir": "config", "patterns_count": 37, "cities_count": 79}
2025-06-12 18:32:20,879 - anonympdf.pdf - INFO - Configuration manager loaded - {"patterns_count": 37, "cities_count": 79}
2025-06-12 18:32:20,880 - anonympdf.pdf - INFO - Priority 2 context-aware components initialized
2025-06-12 18:32:22,812 - anonympdf.pdf - INFO - English spaCy model loaded successfully - {"model": "en_core_web_sm", "components": 6, "method": "standard"}
C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\venv\Lib\site-packages\spacy\util.py:910: UserWarning: [W095] Model 'lt_core_news_sm' (3.8.0) was trained with spaCy v3.8.0 and may not be 100% compatible with the current version (3.7.2). If you see errors or degraded performance, download a newer compatible model or retrain your custom model with the current spaCy version. For more details and available updates, run: python -m spacy validate
  warnings.warn(warn_msg)
2025-06-12 18:32:23,530 - anonympdf.pdf - INFO - Lithuanian spaCy model loaded successfully - {"model": "lt_core_news_sm", "components": 7, "method": "standard"}
______________________________________________ ERROR at setup of TestMorningSes5AntiOverredaction.test_preserve_detection_technical_sections _______________________________________________
tests\test_morning_ses5_improvements.py:156: in pdf_processor_with_test_config
    processor.config['anti_overredaction'] = {
E   AttributeError: 'PDFProcessor' object has no attribute 'config'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:32:23,542 - anonympdf.pdf - INFO - Initializing PDF processor with Priority 2 enhancements
2025-06-12 18:32:23,548 - config_manager - INFO - Patterns loaded from file - {"file": "config\\patterns.yaml", "patterns_count": 37}
2025-06-12 18:32:23,553 - config_manager - INFO - Cities loaded from file - {"file": "config\\cities.yaml", "cities_count": 79}
2025-06-12 18:32:23,560 - config_manager - INFO - Settings loaded from file - {"file": "config\\settings.yaml"}
2025-06-12 18:32:23,560 - config_manager - INFO - Configuration manager initialized - {"config_dir": "config", "patterns_count": 37, "cities_count": 79}
2025-06-12 18:32:23,560 - anonympdf.pdf - INFO - Configuration manager loaded - {"patterns_count": 37, "cities_count": 79}
2025-06-12 18:32:23,561 - anonympdf.pdf - INFO - Priority 2 context-aware components initialized
2025-06-12 18:32:24,424 - anonympdf.pdf - INFO - English spaCy model loaded successfully - {"model": "en_core_web_sm", "components": 6, "method": "standard"}
C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\venv\Lib\site-packages\spacy\util.py:910: UserWarning: [W095] Model 'lt_core_news_sm' (3.8.0) was trained with spaCy v3.8.0 and may not be 100% compatible with the current version (3.7.2). If you see errors or degraded performance, download a newer compatible model or retrain your custom model with the current spaCy version. For more details and available updates, run: python -m spacy validate
  warnings.warn(warn_msg)
2025-06-12 18:32:25,131 - anonympdf.pdf - INFO - Lithuanian spaCy model loaded successfully - {"model": "lt_core_news_sm", "components": 7, "method": "standard"}
______________________________________________ ERROR at setup of TestMorningSes5AntiOverredaction.test_no_preserve_pii_in_technical_sections _______________________________________________
tests\test_morning_ses5_improvements.py:156: in pdf_processor_with_test_config
    processor.config['anti_overredaction'] = {
E   AttributeError: 'PDFProcessor' object has no attribute 'config'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:32:25,147 - anonympdf.pdf - INFO - Initializing PDF processor with Priority 2 enhancements
2025-06-12 18:32:25,157 - config_manager - INFO - Patterns loaded from file - {"file": "config\\patterns.yaml", "patterns_count": 37}
2025-06-12 18:32:25,163 - config_manager - INFO - Cities loaded from file - {"file": "config\\cities.yaml", "cities_count": 79}
2025-06-12 18:32:25,173 - config_manager - INFO - Settings loaded from file - {"file": "config\\settings.yaml"}
2025-06-12 18:32:25,173 - config_manager - INFO - Configuration manager initialized - {"config_dir": "config", "patterns_count": 37, "cities_count": 79}
2025-06-12 18:32:25,174 - anonympdf.pdf - INFO - Configuration manager loaded - {"patterns_count": 37, "cities_count": 79}
2025-06-12 18:32:25,174 - anonympdf.pdf - INFO - Priority 2 context-aware components initialized
2025-06-12 18:32:25,803 - anonympdf.pdf - INFO - English spaCy model loaded successfully - {"model": "en_core_web_sm", "components": 6, "method": "standard"}
C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\venv\Lib\site-packages\spacy\util.py:910: UserWarning: [W095] Model 'lt_core_news_sm' (3.8.0) was trained with spaCy v3.8.0 and may not be 100% compatible with the current version (3.7.2). If you see errors or degraded performance, download a newer compatible model or retrain your custom model with the current spaCy version. For more details and available updates, run: python -m spacy validate
  warnings.warn(warn_msg)
2025-06-12 18:32:26,287 - anonympdf.pdf - INFO - Lithuanian spaCy model loaded successfully - {"model": "lt_core_news_sm", "components": 7, "method": "standard"}
_____________________________________________ ERROR at setup of TestMorningSes5AntiOverredaction.test_preserve_detection_technical_indicators ______________________________________________
tests\test_morning_ses5_improvements.py:156: in pdf_processor_with_test_config
    processor.config['anti_overredaction'] = {
E   AttributeError: 'PDFProcessor' object has no attribute 'config'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:32:26,299 - anonympdf.pdf - INFO - Initializing PDF processor with Priority 2 enhancements
2025-06-12 18:32:26,304 - config_manager - INFO - Patterns loaded from file - {"file": "config\\patterns.yaml", "patterns_count": 37}
2025-06-12 18:32:26,308 - config_manager - INFO - Cities loaded from file - {"file": "config\\cities.yaml", "cities_count": 79}
2025-06-12 18:32:26,319 - config_manager - INFO - Settings loaded from file - {"file": "config\\settings.yaml"}
2025-06-12 18:32:26,319 - config_manager - INFO - Configuration manager initialized - {"config_dir": "config", "patterns_count": 37, "cities_count": 79}
2025-06-12 18:32:26,320 - anonympdf.pdf - INFO - Configuration manager loaded - {"patterns_count": 37, "cities_count": 79}
2025-06-12 18:32:26,320 - anonympdf.pdf - INFO - Priority 2 context-aware components initialized
2025-06-12 18:32:26,905 - anonympdf.pdf - INFO - English spaCy model loaded successfully - {"model": "en_core_web_sm", "components": 6, "method": "standard"}
C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\venv\Lib\site-packages\spacy\util.py:910: UserWarning: [W095] Model 'lt_core_news_sm' (3.8.0) was trained with spaCy v3.8.0 and may not be 100% compatible with the current version (3.7.2). If you see errors or degraded performance, download a newer compatible model or retrain your custom model with the current spaCy version. For more details and available updates, run: python -m spacy validate
  warnings.warn(warn_msg)
2025-06-12 18:32:27,463 - anonympdf.pdf - INFO - Lithuanian spaCy model loaded successfully - {"model": "lt_core_news_sm", "components": 7, "method": "standard"}
__________________________________________________ ERROR at setup of TestMorningSes5AntiOverredaction.test_no_preserve_regular_detections __________________________________________________
tests\test_morning_ses5_improvements.py:156: in pdf_processor_with_test_config
    processor.config['anti_overredaction'] = {
E   AttributeError: 'PDFProcessor' object has no attribute 'config'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:32:27,475 - anonympdf.pdf - INFO - Initializing PDF processor with Priority 2 enhancements
2025-06-12 18:32:27,481 - config_manager - INFO - Patterns loaded from file - {"file": "config\\patterns.yaml", "patterns_count": 37}
2025-06-12 18:32:27,488 - config_manager - INFO - Cities loaded from file - {"file": "config\\cities.yaml", "cities_count": 79}
2025-06-12 18:32:27,493 - config_manager - INFO - Settings loaded from file - {"file": "config\\settings.yaml"}
2025-06-12 18:32:27,494 - config_manager - INFO - Configuration manager initialized - {"config_dir": "config", "patterns_count": 37, "cities_count": 79}
2025-06-12 18:32:27,494 - anonympdf.pdf - INFO - Configuration manager loaded - {"patterns_count": 37, "cities_count": 79}
2025-06-12 18:32:27,494 - anonympdf.pdf - INFO - Priority 2 context-aware components initialized
2025-06-12 18:32:28,075 - anonympdf.pdf - INFO - English spaCy model loaded successfully - {"model": "en_core_web_sm", "components": 6, "method": "standard"}
C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\venv\Lib\site-packages\spacy\util.py:910: UserWarning: [W095] Model 'lt_core_news_sm' (3.8.0) was trained with spaCy v3.8.0 and may not be 100% compatible with the current version (3.7.2). If you see errors or degraded performance, download a newer compatible model or retrain your custom model with the current spaCy version. For more details and available updates, run: python -m spacy validate
  warnings.warn(warn_msg)
2025-06-12 18:32:28,581 - anonympdf.pdf - INFO - Lithuanian spaCy model loaded successfully - {"model": "lt_core_news_sm", "components": 7, "method": "standard"}
____________________________________________________ ERROR at setup of TestPerformanceOptimizedProcessor.test_processor_initialization _____________________________________________________
tests\test_performance_enhanced.py:331: in setup_method
    self.processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
__________________________________________________ ERROR at setup of TestPerformanceOptimizedProcessor.test_optimized_processing_session ___________________________________________________
tests\test_performance_enhanced.py:331: in setup_method
    self.processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
____________________________________________________ ERROR at setup of TestPerformanceOptimizedProcessor.test_parallel_file_processing _____________________________________________________
tests\test_performance_enhanced.py:331: in setup_method
    self.processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
_____________________________________________________ ERROR at setup of TestPerformanceOptimizedProcessor.test_empty_files_processing ______________________________________________________
tests\test_performance_enhanced.py:331: in setup_method
    self.processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
_______________________________________________ ERROR at setup of TestPerformanceOptimizedProcessor.test_single_file_processing_with_caching _______________________________________________
tests\test_performance_enhanced.py:331: in setup_method
    self.processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
__________________________________________________________ ERROR at setup of TestParallelProcessor.test_determine_processing_mode __________________________________________________________
tests\test_performance_optimizer.py:106: in setup_method
    self.processor = ParallelProcessor(config=config)
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
___________________________________________________________ ERROR at setup of TestParallelProcessor.test_process_single_document ___________________________________________________________
tests\test_performance_optimizer.py:106: in setup_method
    self.processor = ParallelProcessor(config=config)
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
__________________________________________________________ ERROR at setup of TestParallelProcessor.test_process_batch_sequential ___________________________________________________________
tests\test_performance_optimizer.py:106: in setup_method
    self.processor = ParallelProcessor(config=config)
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
_______________________________________________________ ERROR at setup of TestParallelProcessor.test_process_batch_parallel_threads ________________________________________________________
tests\test_performance_optimizer.py:106: in setup_method
    self.processor = ParallelProcessor(config=config)
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
________________________________________________________________ ERROR at setup of TestParallelProcessor.test_execute_task _________________________________________________________________
tests\test_performance_optimizer.py:106: in setup_method
    self.processor = ParallelProcessor(config=config)
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
___________________________________________________________ ERROR at setup of TestParallelProcessor.test_execute_task_with_error ___________________________________________________________
tests\test_performance_optimizer.py:106: in setup_method
    self.processor = ParallelProcessor(config=config)
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
___________________________________________________________________ ERROR at setup of TestBatchEngine.test_submit_batch ____________________________________________________________________
tests\test_performance_optimizer.py:215: in setup_method
    self.batch_engine = BatchEngine(config=config)
app\core\performance_optimizer.py:523: in __init__
    self.config = config or get_config()['performance']
E   KeyError: 'performance'
________________________________________________________________ ERROR at setup of TestBatchEngine.test_process_next_batch _________________________________________________________________
tests\test_performance_optimizer.py:215: in setup_method
    self.batch_engine = BatchEngine(config=config)
app\core\performance_optimizer.py:523: in __init__
    self.config = config or get_config()['performance']
E   KeyError: 'performance'
__________________________________________________________________ ERROR at setup of TestBatchEngine.test_get_queue_stats __________________________________________________________________
tests\test_performance_optimizer.py:215: in setup_method
    self.batch_engine = BatchEngine(config=config)
app\core\performance_optimizer.py:523: in __init__
    self.config = config or get_config()['performance']
E   KeyError: 'performance'
________________________________________________________________ ERROR at setup of TestBatchEngine.test_process_empty_queue ________________________________________________________________
tests\test_performance_optimizer.py:215: in setup_method
    self.batch_engine = BatchEngine(config=config)
app\core\performance_optimizer.py:523: in __init__
    self.config = config or get_config()['performance']
E   KeyError: 'performance'
_________________________________________________________ ERROR at teardown of TestTrainingDataStorage.test_storage_initialization _________________________________________________________
..\..\..\AppData\Local\Programs\Python\Python311\Lib\shutil.py:632: in _rmtree_unsafe
    os.unlink(fullname)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\tomas\\AppData\\Local\\Temp\\tmp76ktpki3\\training_data.db'

During handling of the above exception, another exception occurred:
tests\test_training_data_collector.py:50: in temp_db_dir
    with tempfile.TemporaryDirectory() as tmpdir:
..\..\..\AppData\Local\Programs\Python\Python311\Lib\tempfile.py:943: in __exit__
    self.cleanup()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\tempfile.py:947: in cleanup
    self._rmtree(self.name, ignore_errors=self._ignore_cleanup_errors)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\tempfile.py:929: in _rmtree
    _shutil.rmtree(name, onerror=onerror)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\shutil.py:787: in rmtree
    return _rmtree_unsafe(path, onerror)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\shutil.py:634: in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
..\..\..\AppData\Local\Programs\Python\Python311\Lib\tempfile.py:893: in onerror
    _os.unlink(path)
E   PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\tomas\\AppData\\Local\\Temp\\tmp76ktpki3\\training_data.db'
__________________________________________________________________________ ERROR at setup of test_initialization ___________________________________________________________________________
tests\adaptive\test_coordinator.py:25: in mock_subsystems
    with patch('app.core.adaptive.coordinator.PatternLearner') as MockPatternLearner, \
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the attribute 'PatternLearner'
_________________________________________________________________ ERROR at setup of test_process_feedback_and_learn_cycle __________________________________________________________________
tests\adaptive\test_coordinator.py:25: in mock_subsystems
    with patch('app.core.adaptive.coordinator.PatternLearner') as MockPatternLearner, \
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the attribute 'PatternLearner'
_________________________________________________________________ ERROR at setup of test_process_feedback_with_no_new_pii __________________________________________________________________
tests\adaptive\test_coordinator.py:25: in mock_subsystems
    with patch('app.core.adaptive.coordinator.PatternLearner') as MockPatternLearner, \
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the attribute 'PatternLearner'
______________________________________________________________________ ERROR at setup of test_ab_testing_integration _______________________________________________________________________
tests\adaptive\test_coordinator.py:25: in mock_subsystems
    with patch('app.core.adaptive.coordinator.PatternLearner') as MockPatternLearner, \
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the attribute 'PatternLearner'
_____________________________________________________________________ ERROR at setup of test_evaluate_and_log_ab_test ______________________________________________________________________
tests\adaptive\test_coordinator.py:25: in mock_subsystems
    with patch('app.core.adaptive.coordinator.PatternLearner') as MockPatternLearner, \
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the attribute 'PatternLearner'
___________________________________________________________________________ ERROR at setup of test_close_method ____________________________________________________________________________
tests\adaptive\test_coordinator.py:25: in mock_subsystems
    with patch('app.core.adaptive.coordinator.PatternLearner') as MockPatternLearner, \
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the attribute 'PatternLearner'
_________________________________________________________________________ ERROR at setup of test_fixture_creation __________________________________________________________________________
tests\system\test_adaptive_workflow.py:83: in adaptive_system_fixture
    quality_analyzer = QualityAnalyzer(storage_path=ANALYTICS_DB_PATH)
E   TypeError: QualityAnalyzer.__init__() got an unexpected keyword argument 'storage_path'
_________________________________________________________ ERROR at setup of test_feedback_creates_pattern_and_overrides_prediction _________________________________________________________
tests\system\test_adaptive_workflow.py:83: in adaptive_system_fixture
    quality_analyzer = QualityAnalyzer(storage_path=ANALYTICS_DB_PATH)
E   TypeError: QualityAnalyzer.__init__() got an unexpected keyword argument 'storage_path'
_____________________________________________________________________ ERROR at setup of test_ab_testing_full_lifecycle _____________________________________________________________________
tests\system\test_adaptive_workflow.py:83: in adaptive_system_fixture
    quality_analyzer = QualityAnalyzer(storage_path=ANALYTICS_DB_PATH)
E   TypeError: QualityAnalyzer.__init__() got an unexpected keyword argument 'storage_path'
========================================================================================= FAILURES =========================================================================================
______________________________________________________________________ TestQualityAnalyzer.test_add_detection_result _______________________________________________________________________
tests\test_analytics_engine.py:108: in test_add_detection_result
    self.analyzer.add_detection_result(result)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:24,722 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:24,722 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpvwdpm0w5\\test_analytics.db"}}
_____________________________________________________________ TestQualityAnalyzer.test_add_detection_result_with_ground_truth ______________________________________________________________
tests\test_analytics_engine.py:118: in test_add_detection_result_with_ground_truth
    self.analyzer.add_detection_result(result, ground_truth=True)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:25,272 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:25,272 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpt6332ezo\\test_analytics.db"}}
____________________________________________________________ TestQualityAnalyzer.test_analyze_detection_quality_single_category ____________________________________________________________
tests\test_analytics_engine.py:137: in test_analyze_detection_quality_single_category
    self.analyzer.add_detection_result(result)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:25,401 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:25,401 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpzj4hs7hu\\test_analytics.db"}}
__________________________________________________________ TestQualityAnalyzer.test_analyze_detection_quality_multiple_categories __________________________________________________________
tests\test_analytics_engine.py:155: in test_analyze_detection_quality_multiple_categories
    self.analyzer.add_detection_result(result)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:25,466 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:25,467 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpf_gi5i66\\test_analytics.db"}}
_______________________________________________________ TestQualityAnalyzer.test_analyze_detection_quality_with_document_type_filter _______________________________________________________
tests\test_analytics_engine.py:168: in test_analyze_detection_quality_with_document_type_filter
    self.analyzer.add_detection_result(result_doc_A_cat1)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:25,534 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:25,535 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpxlkb88lr\\test_analytics.db"}}
___________________________________________________________ TestQualityAnalyzer.test_analyze_detection_quality_with_ground_truth ___________________________________________________________
tests\test_analytics_engine.py:212: in test_analyze_detection_quality_with_ground_truth
    self.analyzer.add_detection_result(result, ground_truth=True)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:25,600 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:25,600 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpjp2_cg5b\\test_analytics.db"}}
______________________________________________________________ TestQualityAnalyzer.test_detect_quality_issues_low_confidence _______________________________________________________________
tests\test_analytics_engine.py:231: in test_detect_quality_issues_low_confidence
    self.analyzer.add_detection_result(result)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:25,667 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:25,667 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmp_a3yirah\\test_analytics.db"}}
__________________________________________________________ TestQualityAnalyzer.test_detect_quality_issues_performance_degradation __________________________________________________________
tests\test_analytics_engine.py:245: in test_detect_quality_issues_performance_degradation
    self.analyzer.add_detection_result(result)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:25,731 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:25,731 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmp45dec7sf\\test_analytics.db"}}
____________________________________________________________ TestQualityAnalyzer.test_detect_quality_issues_high_false_positive ____________________________________________________________
tests\test_analytics_engine.py:258: in test_detect_quality_issues_high_false_positive
    self.analyzer.add_detection_result(result, ground_truth=False)  # False positive
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:25,799 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:25,799 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmp94gz19_7\\test_analytics.db"}}
____________________________________________________________________ TestQualityAnalyzer.test_get_quality_report_empty _____________________________________________________________________
tests\test_analytics_engine.py:272: in test_get_quality_report_empty
    report = self.analyzer.get_quality_report()
E   AttributeError: 'QualityAnalyzer' object has no attribute 'get_quality_report'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:25,863 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:25,864 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpqj5_4qot\\test_analytics.db"}}
__________________________________________________________________ TestQualityAnalyzer.test_get_quality_report_with_data ___________________________________________________________________
tests\test_analytics_engine.py:286: in test_get_quality_report_with_data
    self.analyzer.add_detection_result(result)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:25,932 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:25,932 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmp1wtqevey\\test_analytics.db"}}
______________________________________________________________ TestQualityAnalyzer.test_get_improvement_suggestions_no_issues ______________________________________________________________
tests\test_analytics_engine.py:300: in test_get_improvement_suggestions_no_issues
    suggestions = self.analyzer.get_improvement_suggestions()
E   AttributeError: 'QualityAnalyzer' object has no attribute 'get_improvement_suggestions'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:25,996 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:25,996 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmp_4u5pnbl\\test_analytics.db"}}
_____________________________________________________________ TestQualityAnalyzer.test_get_improvement_suggestions_with_issues _____________________________________________________________
tests\test_analytics_engine.py:316: in test_get_improvement_suggestions_with_issues
    self.analyzer.quality_issues.append(issue)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'quality_issues'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:26,057 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:26,058 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpjr570nkf\\test_analytics.db"}}
_______________________________________________________________________ TestQualityAnalyzer.test_storage_integration _______________________________________________________________________
tests\test_analytics_engine.py:329: in test_storage_integration
    self.analyzer.add_detection_result(result1)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:26,123 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:26,124 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpaeoo70wa\\test_analytics.db"}}
______________________________________________________________ TestQualityAnalyzer.test_get_quality_trends_insufficient_data _______________________________________________________________
tests\test_analytics_engine.py:345: in test_get_quality_trends_insufficient_data
    trend = self.analyzer.get_quality_trends(category="CAT_TREND", metric_name="avg_confidence")
E   AttributeError: 'QualityAnalyzer' object has no attribute 'get_quality_trends'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:26,186 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:26,187 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmp_mvyf6p2\\test_analytics.db"}}
_________________________________________________________________ TestQualityAnalyzer.test_get_quality_trends_valid_metric _________________________________________________________________
tests\test_analytics_engine.py:358: in test_get_quality_trends_valid_metric
    conn = sqlite3.connect(self.analyzer.storage_path)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'storage_path'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:26,252 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:26,253 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmp3d7dz8ko\\test_analytics.db"}}
__________________________________________________________________ TestQualityAnalyzer.test_get_quality_trends_declining ___________________________________________________________________
tests\test_analytics_engine.py:393: in test_get_quality_trends_declining
    conn = sqlite3.connect(self.analyzer.storage_path)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'storage_path'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:26,407 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:26,408 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpqf6g0we2\\test_analytics.db"}}
________________________________________________________________ TestQualityAnalyzer.test_get_quality_trends_invalid_metric ________________________________________________________________
tests\test_analytics_engine.py:413: in test_get_quality_trends_invalid_metric
    trend = self.analyzer.get_quality_trends(category="CAT_ANY", metric_name="non_existent_metric")
E   AttributeError: 'QualityAnalyzer' object has no attribute 'get_quality_trends'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:26,467 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:26,468 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmp_59sauwa\\test_analytics.db"}}
__________________________________________________________________________ TestQualityAnalyzer.test_thread_safety __________________________________________________________________________
tests\test_analytics_engine.py:437: in test_thread_safety
    assert len(self.analyzer.detection_history) == 30
E   AttributeError: 'QualityAnalyzer' object has no attribute 'detection_history'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:26,534 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:26,535 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmp66akvyn3\\test_analytics.db"}}
_______________________________________________________________________ TestQualityAnalyzer.test_config_integration ________________________________________________________________________
tests\test_analytics_engine.py:446: in test_config_integration
    'storage_path': str(self.analyzer.storage_path),
E   AttributeError: 'QualityAnalyzer' object has no attribute 'storage_path'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:26,643 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:26,644 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpizlax5jy\\test_analytics.db"}}
__________________________________________________________________ TestQualityAnalyzer.test_ml_integration_compatibility ___________________________________________________________________
tests\test_analytics_engine.py:471: in test_ml_integration_compatibility
    self.analyzer.add_detection_result(result)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:26,710 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:26,711 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpqu3gu_kg\\test_analytics.db"}}
_______________________________________________________________________ TestQualityAnalyzer.test_performance_impact ________________________________________________________________________
tests\test_analytics_engine.py:502: in test_performance_impact
    self.analyzer.add_detection_result(result)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:26,778 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:26,779 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpgng_pawf\\test_analytics.db"}}
____________________________________________________________ TestQualityInsightsGenerator.test_generate_pattern_insights_empty _____________________________________________________________
tests\test_analytics_engine.py:549: in test_generate_pattern_insights_empty
    insights = self.insights_generator.generate_pattern_insights()
E   AttributeError: 'QualityInsightsGenerator' object has no attribute 'generate_pattern_insights'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:26,842 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:26,843 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpbc6y5mlq\\test_insights.db"}}
__________________________________________________________ TestQualityInsightsGenerator.test_generate_pattern_insights_with_data ___________________________________________________________
tests\test_analytics_engine.py:566: in test_generate_pattern_insights_with_data
    self.analyzer.add_detection_result(result)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:27,084 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:27,084 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpa70r4o8a\\test_insights.db"}}
_______________________________________________________ TestQualityInsightsGenerator.test_generate_model_insights_insufficient_data ________________________________________________________
tests\test_analytics_engine.py:592: in test_generate_model_insights_insufficient_data
    insights = self.insights_generator.generate_model_insights()
E   AttributeError: 'QualityInsightsGenerator' object has no attribute 'generate_model_insights'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:27,158 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:27,159 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpa2s20nle\\test_insights.db"}}
________________________________________________________ TestQualityInsightsGenerator.test_generate_model_insights_excellent_model _________________________________________________________
tests\test_analytics_engine.py:601: in test_generate_model_insights_excellent_model
    self.analyzer.add_detection_result(result, ground_truth=True)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:27,239 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:27,240 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmphw6bifs5\\test_insights.db"}}
_______________________________________________________ TestQualityInsightsGenerator.test_generate_model_insights_needs_improvement ________________________________________________________
tests\test_analytics_engine.py:618: in test_generate_model_insights_needs_improvement
    self.analyzer.add_detection_result(result, ground_truth=True)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:27,315 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:27,316 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmp_2d1k248\\test_insights.db"}}
_______________________________________________________________ TestQualityInsightsGenerator.test_generate_report_with_data ________________________________________________________________
tests\test_analytics_engine.py:639: in test_generate_report_with_data
    self.analyzer.add_detection_result(result)
E   AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:27,392 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:27,393 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\tmpt9epmcnm\\test_insights.db"}}
________________________________________________________________ TestAnalyticsEngineIntegration.test_full_analysis_workflow ________________________________________________________________
tests\test_analytics_engine.py:671: in test_full_analysis_workflow
    result = self.create_mock_detection_result()
E   AttributeError: 'TestAnalyticsEngineIntegration' object has no attribute 'create_mock_detection_result'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:31:27,523 - anonympdf.ml_monitoring - INFO - ML Performance Monitor initialized
2025-06-12 18:31:27,524 - anonympdf.anonympdf.analytics - INFO - QualityAnalyzer initialized - {"extra": {"db_path": "C:\\Users\\tomas\\AppData\\Local\\Temp\\pytest-of-tomas\\pytest-28\\test_full_analysis_workflow0\\integration_analytics.db"}}
--------------------------------------------------------------------------------- Captured stderr teardown ---------------------------------------------------------------------------------
2025-06-12 18:31:27,539 - anonympdf.anonympdf.analytics - INFO - Analytics engine closed.
_____________________________________________________________________ TestConfigManager.test_configuration_validation ______________________________________________________________________
tests\test_config_manager.py:67: in test_configuration_validation
    assert is_valid is True
E   assert False is True
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 18:31:27,633 - config_manager - WARNING - Configuration validation failed - {"error_count": 10, "errors": ["Missing required setting: version", "Missing required setting: language_detection", "Missing required setting: processing", "Missing required setting: logging", "Missing required setting: anti_overredaction", "Missing required adaptive learning setting: enabled", "Missing required adaptive learning setting: databases", "Missing required adaptive learning setting: thresholds", "Missing required adaptive learning setting: performance", "Missing required adaptive learning setting: monitoring"]}
________________________________________________________ TestFeedbackSystemIntegration.test_feedback_submission_and_processing_flow ________________________________________________________
tests\test_feedback_system.py:499: in test_feedback_submission_and_processing_flow
    with patch.object(self.system.training_data_collector, 'save_training_examples') as mock_save:
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1446: in __enter__
    original, local = self.get_original()
..\..\..\AppData\Local\Programs\Python\Python311\Lib\unittest\mock.py:1419: in get_original
    raise AttributeError(
E   AttributeError: <app.core.training_data.TrainingDataCollector object at 0x000001B12607F210> does not have the attribute 'save_training_examples'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:32:08,780 - anonympdf.anonympdf.feedback_system - INFO - FeedbackAnalyzer initialized
2025-06-12 18:32:08,780 - anonympdf.anonympdf.feedback_system - INFO - UserFeedbackProcessor initialized
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 18:32:08,781 - anonympdf.anonympdf.feedback_system - INFO - Feedback submitted: false_positive for ADDRESS - {"feedback_id": "integration_test_001", "document_id": "doc_1"}
_____________________________________________________________________ TestCacheDecorator.test_function_result_caching ______________________________________________________________________
tests\test_intelligent_cache.py:493: in test_function_result_caching
    get_intelligent_cache().clear_all()
app\core\intelligent_cache.py:577: in get_intelligent_cache
    instance = IntelligentCache(config=config)
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
_______________________________________________________________________ TestCacheDecorator.test_custom_key_function ________________________________________________________________________
tests\test_intelligent_cache.py:524: in test_custom_key_function
    get_intelligent_cache().clear_all()
app\core\intelligent_cache.py:577: in get_intelligent_cache
    instance = IntelligentCache(config=config)
app\core\intelligent_cache.py:347: in __init__
    self.config = config or get_config()['performance']['caching']
E   KeyError: 'performance'
______________________________________________________________________ TestIntegration.test_memory_threshold_handling ______________________________________________________________________
tests\test_memory_optimizer.py:700: in test_memory_threshold_handling
    assert len(high_mem_calls) > 0, "MemoryMonitor should log a warning for high memory usage"
E   AssertionError: MemoryMonitor should log a warning for high memory usage
E   assert 0 > 0
E    +  where 0 = len([])
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:32:19,185 - anonympdf.memory_optimizer - INFO - GarbageCollectionManager initialized
2025-06-12 18:32:19,185 - anonympdf.memory_optimizer - INFO - MemoryMonitor initialized
2025-06-12 18:32:19,186 - anonympdf.memory_optimizer - INFO - MemoryOptimizer initialized. Config: {}
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 18:32:19,189 - anonympdf.memory_optimizer - INFO - MemoryOptimizer.start_optimization() called. Starting memory monitoring.
2025-06-12 18:32:19,239 - anonympdf.memory_optimizer - INFO - Memory monitoring started
2025-06-12 18:32:19,315 - anonympdf.memory_optimizer - INFO - Memory baseline set - {"baseline_mb": 100.0}
--------------------------------------------------------------------------------- Captured stderr teardown ---------------------------------------------------------------------------------
2025-06-12 18:32:19,531 - anonympdf.memory_optimizer - WARNING - High memory usage detected - {"memory_percent": 75.0, "rss_mb": 100.0}
2025-06-12 18:32:19,611 - anonympdf.memory_optimizer - INFO - MemoryOptimizer.stop_optimization() called. Stopping memory monitoring.
2025-06-12 18:32:19,611 - anonympdf.memory_optimizer - WARNING - Critical memory usage detected - {"memory_percent": 94.3, "rss_mb": 2910.71484375}
2025-06-12 18:32:19,623 - anonympdf.memory_optimizer - INFO - Memory monitoring stopped
____________________________________________________________ TestMorningSes5Patterns.test_enhanced_car_plate_contextual_pattern ____________________________________________________________
tests\test_morning_ses5_improvements.py:25: in test_enhanced_car_plate_contextual_pattern
    pattern = pdf_processor.patterns.get("lithuanian_car_plate_contextual")
E   AttributeError: 'PDFProcessor' object has no attribute 'patterns'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:32:19,783 - anonympdf.pdf - INFO - Initializing PDF processor with Priority 2 enhancements
2025-06-12 18:32:19,792 - config_manager - INFO - Patterns loaded from file - {"file": "config\\patterns.yaml", "patterns_count": 37}
2025-06-12 18:32:19,797 - config_manager - INFO - Cities loaded from file - {"file": "config\\cities.yaml", "cities_count": 79}
2025-06-12 18:32:19,807 - config_manager - INFO - Settings loaded from file - {"file": "config\\settings.yaml"}
2025-06-12 18:32:19,808 - config_manager - INFO - Configuration manager initialized - {"config_dir": "config", "patterns_count": 37, "cities_count": 79}
2025-06-12 18:32:19,808 - anonympdf.pdf - INFO - Configuration manager loaded - {"patterns_count": 37, "cities_count": 79}
2025-06-12 18:32:19,809 - anonympdf.pdf - INFO - Priority 2 context-aware components initialized
2025-06-12 18:32:20,359 - anonympdf.pdf - INFO - English spaCy model loaded successfully - {"model": "en_core_web_sm", "components": 6, "method": "standard"}
C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\venv\Lib\site-packages\spacy\util.py:910: UserWarning: [W095] Model 'lt_core_news_sm' (3.8.0) was trained with spaCy v3.8.0 and may not be 100% compatible with the current version (3.7.2). If you see errors or degraded performance, download a newer compatible model or retrain your custom model with the current spaCy version. For more details and available updates, run: python -m spacy validate
  warnings.warn(warn_msg)
2025-06-12 18:32:20,799 - anonympdf.pdf - INFO - Lithuanian spaCy model loaded successfully - {"model": "lt_core_news_sm", "components": 7, "method": "standard"}
_____________________________________________________________ TestMorningSes5Patterns.test_enhanced_car_plate_enhanced_pattern _____________________________________________________________
tests\test_morning_ses5_improvements.py:45: in test_enhanced_car_plate_enhanced_pattern
    pattern = pdf_processor.patterns.get("lithuanian_car_plate_enhanced")
E   AttributeError: 'PDFProcessor' object has no attribute 'patterns'
______________________________________________________________ TestMorningSes5Patterns.test_lithuanian_name_all_caps_pattern _______________________________________________________________
tests\test_morning_ses5_improvements.py:60: in test_lithuanian_name_all_caps_pattern
    pattern = pdf_processor.patterns.get("lithuanian_name_all_caps")
E   AttributeError: 'PDFProcessor' object has no attribute 'patterns'
_____________________________________________________________ TestMorningSes5Patterns.test_lithuanian_name_contextual_pattern ______________________________________________________________
tests\test_morning_ses5_improvements.py:83: in test_lithuanian_name_contextual_pattern
    pattern = pdf_processor.patterns.get("lithuanian_name_contextual")
E   AttributeError: 'PDFProcessor' object has no attribute 'patterns'
___________________________________________________________ TestMorningSes5Patterns.test_lithuanian_name_contextual_caps_pattern ___________________________________________________________
tests\test_morning_ses5_improvements.py:99: in test_lithuanian_name_contextual_caps_pattern
    pattern = pdf_processor.patterns.get("lithuanian_name_contextual_caps")
E   AttributeError: 'PDFProcessor' object has no attribute 'patterns'
_____________________________________________________________ TestMorningSes5Patterns.test_lithuanian_address_flexible_pattern _____________________________________________________________
tests\test_morning_ses5_improvements.py:114: in test_lithuanian_address_flexible_pattern
    pattern = pdf_processor.patterns.get("lithuanian_address_flexible")
E   AttributeError: 'PDFProcessor' object has no attribute 'patterns'
_________________________________________________________ TestMorningSes5Patterns.test_lithuanian_personal_code_contextual_pattern _________________________________________________________
tests\test_morning_ses5_improvements.py:131: in test_lithuanian_personal_code_contextual_pattern
    pattern = pdf_processor.patterns.get("lithuanian_personal_code_contextual")
E   AttributeError: 'PDFProcessor' object has no attribute 'patterns'
_______________________________________________________ TestMorningSes5Integration.test_comprehensive_lithuanian_document_processing _______________________________________________________
tests\test_morning_ses5_improvements.py:245: in test_comprehensive_lithuanian_document_processing
    assert len(personal_info["names"]) >= 1, "Should detect STANIULIS TOMAS"
E   KeyError: 'names'
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 18:32:28,595 - anonympdf.pdf - INFO - Using Lithuanian NLP model for processing
2025-06-12 18:32:28,628 - anonympdf.pdf - INFO - Detection preserved due to technical term context - {"text": "Vilei\u0161io g. 11-4", "pattern_type": "lithuanian_address_generic", "technical_term": "kW"}
2025-06-12 18:32:28,629 - anonympdf.pdf - INFO - Detection preserved due to technical term context - {"text": "Adresas: P. Vilei\u0161io g. 11-4", "pattern_type": "lithuanian_address_prefixed", "technical_term": "kW"}
2025-06-12 18:32:28,637 - anonympdf.performance - INFO - Performance tracking: pii_detection - {"duration": 0.042984724044799805, "memory_delta": 0.19140625, "function": "find_personal_info"}
_________________________________________________________ TestMorningSes5Integration.test_anti_overredaction_in_technical_context __________________________________________________________
tests\test_morning_ses5_improvements.py:281: in test_anti_overredaction_in_technical_context
    assert len(personal_info["names"]) >= 1, "Should detect name"
E   KeyError: 'names'
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 18:32:28,646 - anonympdf.pdf - INFO - Using Lithuanian NLP model for processing
2025-06-12 18:32:28,658 - anonympdf.pdf - INFO - Detection preserved due to technical term context - {"text": "38901234567", "pattern_type": "eleven_digit_numeric", "technical_term": "kW"}
2025-06-12 18:32:28,658 - anonympdf.pdf - INFO - Detection preserved due to technical term context - {"text": "38901234567", "pattern_type": "health_insurance_number", "technical_term": "kW"}
2025-06-12 18:32:28,659 - anonympdf.pdf - INFO - Detection preserved due to technical term context - {"text": "38901234567", "pattern_type": "lithuanian_personal_code", "technical_term": "kW"}
2025-06-12 18:32:28,659 - anonympdf.pdf - INFO - Detection preserved due to technical term context - {"text": "asmens kodas: 38901234567", "pattern_type": "lithuanian_personal_code_contextual", "technical_term": "kW"}
2025-06-12 18:32:28,661 - anonympdf.performance - INFO - Performance tracking: pii_detection - {"duration": 0.015438079833984375, "memory_delta": 0.1171875, "function": "find_personal_info"}
_________________________________________________________________________________ test_find_personal_info __________________________________________________________________________________
tests\test_pdf_processor.py:41: in test_find_personal_info
    monkeypatch.setattr(pdf_processor, 'patterns', test_patterns)
E   AttributeError: <app.services.pdf_processor.PDFProcessor object at 0x000001B099C54790> has no attribute 'patterns'
______________________________________________________________________________ test_generate_redaction_report ______________________________________________________________________________
tests\test_pdf_processor.py:59: in test_generate_redaction_report
    monkeypatch.setattr(pdf_processor, 'patterns', test_patterns)
E   AttributeError: <app.services.pdf_processor.PDFProcessor object at 0x000001B099C54790> has no attribute 'patterns'
_______________________________________________________________________ test_process_pdf_failure_on_invalid_content ________________________________________________________________________
tests\test_pdf_processor.py:94: in test_process_pdf_failure_on_invalid_content
    assert "Failed to open document" in result["error"]
E   AssertionError: assert 'Failed to open document' in 'An exception occurred during anonymization'
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 18:32:30,995 - anonympdf.pdf - INFO - Starting PDF processing - {"filename": "C:\\Users\\tomas\\AppData\\Local\\Temp\\pytest-of-tomas\\pytest-28\\test_process_pdf_failure_on_in0\\test.pdf"}
2025-06-12 18:32:31,047 - anonympdf.pdf - INFO - File copied to temp directory - {"filename": "test.pdf", "temp_path": "temp\\test.pdf", "file_size": 52}
2025-06-12 18:32:31,051 - anonympdf.pdf - INFO - Starting PDF anonymization - {"input_path": "temp\\test.pdf", "output_path": "processed\\anonymized_test.pdf"}
2025-06-12 18:32:31,052 - anonympdf.performance - INFO - Performance tracking: text_extraction - {"duration": 0.0, "memory_delta": 0.0, "function": "extract_text_from_pdf"}
2025-06-12 18:32:31,053 - anonympdf.pdf - ERROR - Error in anonymize_pdf: KeyError - 'performance' - {"input_path": "temp\\test.pdf", "output_path": "processed\\anonymized_test.pdf"}
Traceback (most recent call last):
  File "C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\app\services\pdf_processor.py", line 582, in anonymize_pdf
    text = self.extract_text_from_pdf(input_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\app\core\performance.py", line 576, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\app\services\pdf_processor.py", line 791, in extract_text_from_pdf
    return extract_text_enhanced(pdf_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\app\core\intelligent_cache.py", line 621, in wrapper
    cached_result = get_intelligent_cache().get(cache_key, cache_type)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\app\core\intelligent_cache.py", line 577, in get_intelligent_cache
    instance = IntelligentCache(config=config)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\app\core\intelligent_cache.py", line 347, in __init__
    self.config = config or get_config()['performance']['caching']
                            ~~~~~~~~~~~~^^^^^^^^^^^^^^^
KeyError: 'performance'
2025-06-12 18:32:31,055 - anonympdf.pdf - ERROR - BENCHMARK: anonymize_pdf for test.pdf failed after 0.0030 seconds.
2025-06-12 18:32:31,056 - anonympdf.pdf - ERROR - PDF processing failed - {"filename": "test.pdf", "error": "An exception occurred during anonymization", "processing_time": 0.00546717643737793}
2025-06-12 18:32:31,056 - anonympdf.performance - INFO - Performance tracking: pdf_processing - {"duration": 0.009222269058227539, "memory_delta": 0.01171875, "file_size_mb": 4.9591064453125e-05, "file_extension": ".pdf", "operation_type": "pdf_processing"}
2025-06-12 18:32:31,057 - anonympdf.performance - INFO - File processing completed: pdf_processing - {"file_size_mb": 4.9591064453125e-05, "duration": 0.009222269058227539, "throughput": 0.005377317029032341, "memory_delta": 0.01171875}
2025-06-12 18:32:31,058 - anonympdf.pdf - INFO - Temporary file cleaned up - {"temp_path": "temp\\test.pdf"}
__________________________________________________________________ TestPerformanceIntegration.test_get_performance_report __________________________________________________________________
tests\test_performance.py:214: in test_get_performance_report
    report = get_performance_report()
app\core\performance.py:623: in get_performance_report
    report["performance_optimizer_stats"] = get_performance_stats()
app\core\performance_optimizer.py:897: in get_performance_stats
    return get_performance_optimizer().get_optimization_stats()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 18:32:31,827 - anonympdf.performance - INFO - Performance tracking: integration_test - {"duration": 0.05083274841308594, "memory_delta": 0.0}
_____________________________________________________________________ TestGlobalFunctions.test_get_performance_report ______________________________________________________________________
tests\test_performance_enhanced.py:470: in test_get_performance_report
    with global_performance_monitor.track_operation("global_op") as tracker:
E   TypeError: 'dict' object does not support the context manager protocol
_____________________________________________________________________ TestGlobalFunctions.test_get_parallel_processor ______________________________________________________________________
tests\test_performance_enhanced.py:480: in test_get_parallel_processor
    processor = get_parallel_processor()
app\core\performance.py:635: in get_parallel_processor
    return get_optimized_processor()
app\core\performance.py:605: in get_optimized_processor
    _optimized_processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
_______________________________________________________________ TestGlobalFunctions.test_performance_report_with_optimizers ________________________________________________________________
tests\test_performance_enhanced.py:485: in test_performance_report_with_optimizers
    processor = get_optimized_processor() # No longer takes config
app\core\performance.py:605: in get_optimized_processor
    _optimized_processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
___________________________________________________________________ TestIntegration.test_end_to_end_parallel_processing ____________________________________________________________________
tests\test_performance_enhanced.py:495: in test_end_to_end_parallel_processing
    processor = get_optimized_processor() # No longer takes config
app\core\performance.py:605: in get_optimized_processor
    _optimized_processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
____________________________________________________________________ TestIntegration.test_concurrent_metric_collection _____________________________________________________________________
tests\test_performance_enhanced.py:521: in test_concurrent_metric_collection
    processor = get_optimized_processor() # No longer takes config
app\core\performance.py:605: in get_optimized_processor
    _optimized_processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
_______________________________________________________________________ TestIntegration.test_performance_under_load ________________________________________________________________________
tests\test_performance_enhanced.py:543: in test_performance_under_load
    processor = get_optimized_processor() # No longer takes config
app\core\performance.py:605: in get_optimized_processor
    _optimized_processor = PerformanceOptimizedProcessor()
app\core\performance.py:380: in __init__
    self._load_optimizers()
app\core\performance.py:389: in _load_optimizers
    self._performance_optimizer = get_performance_optimizer()
app\core\performance_optimizer.py:891: in get_performance_optimizer
    _performance_optimizer = PerformanceOptimizer(config=config)
app\core\performance_optimizer.py:668: in __init__
    self.parallel_processor = ParallelProcessor(self.config.get('parallel_processing'))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
_____________________________________________________________________ TestGlobalInstances.test_get_parallel_processor ______________________________________________________________________
tests\test_performance_optimizer.py:334: in test_get_parallel_processor
    processor = get_parallel_processor()
app\core\performance_optimizer.py:642: in get_parallel_processor
    _parallel_processor = ParallelProcessor(config=config.get('parallel_processing', {}))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
________________________________________________________________________ TestGlobalInstances.test_get_batch_engine _________________________________________________________________________
tests\test_performance_optimizer.py:341: in test_get_batch_engine
    engine = get_batch_engine()
app\core\performance_optimizer.py:651: in get_batch_engine
    _batch_engine = BatchEngine(config=config)
app\core\performance_optimizer.py:523: in __init__
    self.config = config or get_config()['performance']
E   KeyError: 'performance'
________________________________________________________________________ TestIntegration.test_end_to_end_processing ________________________________________________________________________
tests\test_performance_optimizer.py:357: in test_end_to_end_processing
    batch_engine = get_batch_engine()
app\core\performance_optimizer.py:651: in get_batch_engine
    _batch_engine = BatchEngine(config=config)
app\core\performance_optimizer.py:523: in __init__
    self.config = config or get_config()['performance']
E   KeyError: 'performance'
_________________________________________________________________ TestIntegration.test_performance_improvement_simulation __________________________________________________________________
tests\test_performance_optimizer.py:379: in test_performance_improvement_simulation
    processor = get_parallel_processor()
app\core\performance_optimizer.py:642: in get_parallel_processor
    _parallel_processor = ParallelProcessor(config=config.get('parallel_processing', {}))
app\core\performance_optimizer.py:184: in __init__
    self.config = config or get_config()['performance']['parallel_processing']
E   KeyError: 'performance'
___________________________________________________________________ TestAnomalyDetector.test_alert_threshold_integration ___________________________________________________________________
tests\test_real_time_monitor.py:156: in test_alert_threshold_integration
    assert len(anomalies) > 0
E   assert 0 > 0
E    +  where 0 = len([])
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:32:33,853 - anonympdf.anonympdf.real_time_monitor - INFO - AnomalyDetector initialized with sensitivity: medium, alert_thresholds: 0
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 18:32:33,855 - anonympdf.anonympdf.real_time_monitor - INFO - Added alert threshold for test_metric
________________________________________________________________ TestRealTimeMonitor.test_ml_monitor_callback_functionality ________________________________________________________________
tests\test_real_time_monitor.py:353: in test_ml_monitor_callback_functionality
    assert mock_system.call_count == 1
E   AssertionError: assert 0 == 1
E    +  where 0 = <MagicMock name='get_system_metrics' id='1861598897040'>.call_count
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:32:33,983 - anonympdf.anonympdf.real_time_monitor - INFO - AnomalyDetector initialized with sensitivity: medium, alert_thresholds: 0
2025-06-12 18:32:33,984 - anonympdf.anonympdf.real_time_monitor - INFO - PerformanceAggregator initialized
2025-06-12 18:32:34,012 - anonympdf.anonympdf.real_time_monitor - INFO - RealTimeMonitor initialized
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 18:32:34,015 - anonympdf.anonympdf.real_time_monitor - INFO - Registered as ML metrics callback for automatic forwarding
______________________________________________________________________ TestRealTimeMonitor.test_alert_callback_system ______________________________________________________________________
tests\test_real_time_monitor.py:452: in test_alert_callback_system
    self.monitor._process_anomaly_alerts([mock_anomaly])
app\core\real_time_monitor.py:670: in _process_anomaly_alerts
    self._store_anomaly(anomaly)
app\core\real_time_monitor.py:709: in _store_anomaly
    json.dumps(anomaly.context)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\json\__init__.py:231: in dumps
    return _default_encoder.encode(obj)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\json\encoder.py:200: in encode
    chunks = self.iterencode(o, _one_shot=True)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\json\encoder.py:258: in iterencode
    return _iterencode(o, 0)
..\..\..\AppData\Local\Programs\Python\Python311\Lib\json\encoder.py:180: in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
E   TypeError: Object of type Mock is not JSON serializable
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:32:35,198 - anonympdf.anonympdf.real_time_monitor - INFO - AnomalyDetector initialized with sensitivity: medium, alert_thresholds: 0
2025-06-12 18:32:35,199 - anonympdf.anonympdf.real_time_monitor - INFO - PerformanceAggregator initialized
2025-06-12 18:32:35,231 - anonympdf.anonympdf.real_time_monitor - INFO - RealTimeMonitor initialized
_______________________________________________________________ TestTrainingDataStorage.test_save_and_load_training_examples _______________________________________________________________
tests\test_training_data_collector.py:89: in test_save_and_load_training_examples
    create_dummy_example("123 Main St", "ADDRESS", True, "doc1", source="test_source_1"),
E   TypeError: create_dummy_example() got an unexpected keyword argument 'source'
___________________________________________________________________ TestTrainingDataStorage.test_get_dataset_stats_empty ___________________________________________________________________
tests\test_training_data_collector.py:126: in test_get_dataset_stats_empty
    assert stats.total_samples == 0
E   AttributeError: 'NoneType' object has no attribute 'total_samples'
____________________________________________________________ TestTrainingDataCollector.test_get_balanced_training_set_with_data ____________________________________________________________
tests\test_training_data_collector.py:213: in test_get_balanced_training_set_with_data
    assert stats.total_samples == 13
E   assert 6 == 13
E    +  where 6 = DatasetStats(total_samples=6, positive_samples=3, negative_samples=3, categories={}, document_types={}, date_range=(datetime.datetime(2025, 6, 12, 18, 32, 50, 756636), datetime.datetime(2025, 6, 12, 18, 32, 50, 756636)), quality_score=1.0).total_samples
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 18:32:50,756 - anonympdf.app.core.training_data - INFO - Created balanced training set: 6 examples
_____________________________________________________________________ TestPersonNameValidation.test_length_validation ______________________________________________________________________
tests\test_validation_utils.py:58: in test_length_validation
    assert not validate_person_name("This Is A Very Long Name That Should Be Rejected")
E   AssertionError: assert not True
E    +  where True = validate_person_name('This Is A Very Long Name That Should Be Rejected')
_____________________________________________________________ TestABTestManager.test_record_and_evaluate_metrics_variant_wins ______________________________________________________________
tests\adaptive\test_ab_testing.py:112: in test_record_and_evaluate_metrics_variant_wins
    self.assertEqual(result.metrics_comparison['accuracy']['winner'], 'variant')
E   KeyError: 'winner'
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 18:32:51,061 - anonympdf.ab_testing - INFO - Loading A/B tests from database.
2025-06-12 18:32:51,062 - anonympdf.ab_testing - INFO - Loaded 0 tests.
2025-06-12 18:32:51,063 - anonympdf.ab_testing - INFO - ABTestManager initialized with database at test_ab_manager.db.
2025-06-12 18:32:51,064 - anonympdf.ab_testing - INFO - Saving test ab_de0969e2 to database.
2025-06-12 18:32:51,069 - anonympdf.ab_testing - INFO - Created new A/B test 'Evaluation Test' with ID ab_de0969e2.
2025-06-12 18:32:51,069 - anonympdf.ab_testing - INFO - Saving test ab_de0969e2 to database.
2025-06-12 18:32:51,076 - anonympdf.ab_testing - INFO - Started A/B test 'Evaluation Test' (ID: ab_de0969e2).
C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF\venv\Lib\site-packages\scipy\stats\_axis_nan_policy.py:586: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  res = hypotest_fun_out(*samples, **kwds)
2025-06-12 18:32:51,469 - anonympdf.ab_testing - INFO - Database connection to test_ab_manager.db closed.
_______________________________________________________ TestOnlineLearner.test_retrain_model_saves_examples_and_triggers_retraining ________________________________________________________
tests\adaptive\test_online_learner.py:123: in test_retrain_model_saves_examples_and_triggers_retraining
    online_learner.retrain_model(sample_training_examples)
E   AttributeError: 'OnlineLearner' object has no attribute 'retrain_model'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:32:53,538 - anonympdf.adaptive_learning.online_learner - INFO - OnlineLearner initialized.
_________________________________________________________ TestOnlineLearner.test_retrain_model_saves_examples_but_skips_retraining _________________________________________________________
tests\adaptive\test_online_learner.py:134: in test_retrain_model_saves_examples_but_skips_retraining
    online_learner.retrain_model(sample_training_examples)
E   AttributeError: 'OnlineLearner' object has no attribute 'retrain_model'
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:32:53,556 - anonympdf.adaptive_learning.online_learner - INFO - OnlineLearner initialized.
__________________________________________________________________ TestPatternLearner.test_discover_and_validate_patterns __________________________________________________________________
tests\adaptive\test_pattern_learner.py:39: in test_discover_and_validate_patterns
    assert len(patterns) == 1
E   assert 0 == 1
E    +  where 0 = len([])
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------
2025-06-12 18:32:54,440 - anonympdf.app.core.adaptive.pattern_learner - INFO - PatternLearner initialized - {"min_confidence": 0.8, "min_samples": 3}
----------------------------------------------------------------------------------- Captured stderr call -----------------------------------------------------------------------------------
2025-06-12 18:32:54,443 - anonympdf.app.core.adaptive.pattern_learner - WARNING - Insufficient samples for pattern discovery. Need 3, got 1
=================================================================================== slowest 10 durations ===================================================================================
3.95s setup    tests/test_feedback_system.py::TestUserFeedbackProcessor::test_should_trigger_retrain_time
3.86s setup    tests/test_feedback_system.py::TestFeedbackSystemIntegration::test_config_integration
3.81s setup    tests/test_feedback_system.py::TestFeedbackSystemIntegration::test_feedback_submission_and_processing_flow
3.60s setup    tests/test_feedback_system.py::TestFeedbackSystemIntegration::test_concurrent_feedback_submission
3.57s setup    tests/test_feedback_system.py::TestUserFeedbackProcessor::test_get_feedback_stats
3.53s setup    tests/test_training_data_collector.py::TestTrainingDataCollector::test_collect_all_training_data_empty_storage
3.41s setup    tests/test_feedback_system.py::TestUserFeedbackProcessor::test_feedback_to_training_example_false_positive
3.37s setup    tests/test_feedback_system.py::TestUserFeedbackProcessor::test_validate_feedback_invalid
3.37s setup    tests/test_training_data_collector.py::TestTrainingDataCollector::test_collector_initialization
3.24s setup    tests/test_feedback_system.py::TestUserFeedbackProcessor::test_validate_feedback_valid
================================================================================= short test summary info ==================================================================================
ERROR tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_pattern_insights_empty - NameError: name 'shutil' is not defined
ERROR tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_pattern_insights_with_data - NameError: name 'shutil' is not defined
ERROR tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_model_insights_insufficient_data - NameError: name 'shutil' is not defined
ERROR tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_model_insights_excellent_model - NameError: name 'shutil' is not defined
ERROR tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_model_insights_needs_improvement - NameError: name 'shutil' is not defined
ERROR tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_report_with_data - NameError: name 'shutil' is not defined
ERROR tests/test_intelligent_cache.py::TestIntelligentCache::test_general_cache_operations - KeyError: 'performance'
ERROR tests/test_intelligent_cache.py::TestIntelligentCache::test_pattern_cache_integration - KeyError: 'performance'
ERROR tests/test_intelligent_cache.py::TestIntelligentCache::test_model_cache_integration - KeyError: 'performance'
ERROR tests/test_intelligent_cache.py::TestIntelligentCache::test_comprehensive_stats - KeyError: 'performance'
ERROR tests/test_intelligent_cache.py::TestIntelligentCache::test_cache_cleanup - KeyError: 'performance'
ERROR tests/test_intelligent_cache.py::TestIntelligentCache::test_clear_all_caches - KeyError: 'performance'
ERROR tests/test_intelligent_cache.py::TestGlobalCacheFunctions::test_cache_get_put - KeyError: 'performance'
ERROR tests/test_intelligent_cache.py::TestGlobalCacheFunctions::test_cache_pattern_function - KeyError: 'performance'
ERROR tests/test_intelligent_cache.py::TestGlobalCacheFunctions::test_cache_model_prediction_function - KeyError: 'performance'
ERROR tests/test_intelligent_cache.py::TestConcurrency::test_thread_safety - KeyError: 'performance'
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerFeedback::test_add_user_feedback_confirmed_correct - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerFeedback::test_add_user_feedback_false_positive - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerFeedback::test_add_user_feedback_category_correction - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerFeedback::test_add_user_feedback_context_details - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerFeedback::test_add_user_feedback_handles_uuid - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerFeedback::test_add_user_feedback_handles_user_feedback_system_failure - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerDetectionProcessing::test_detect_with_ml_integration_calls_quality_analyzer - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLIntegrationLayerDetectionProcessing::test_detect_with_ml_integration_calls_quality_analyzer_on_fallback - NameError: name 'Mock' is not defined
ERROR tests/test_ml_integration_layer.py::TestMLConfidenceScorerIntegration::test_adaptive_pattern_overrides_ml_model - NameError: name 'Mock' is not defined
ERROR tests/test_morning_ses5_improvements.py::TestMorningSes5AntiOverredaction::test_preserve_detection_technical_terms - AttributeError: 'PDFProcessor' object has no attribute 'config'
ERROR tests/test_morning_ses5_improvements.py::TestMorningSes5AntiOverredaction::test_preserve_detection_technical_sections - AttributeError: 'PDFProcessor' object has no attribute 'config'
ERROR tests/test_morning_ses5_improvements.py::TestMorningSes5AntiOverredaction::test_no_preserve_pii_in_technical_sections - AttributeError: 'PDFProcessor' object has no attribute 'config'
ERROR tests/test_morning_ses5_improvements.py::TestMorningSes5AntiOverredaction::test_preserve_detection_technical_indicators - AttributeError: 'PDFProcessor' object has no attribute 'config'
ERROR tests/test_morning_ses5_improvements.py::TestMorningSes5AntiOverredaction::test_no_preserve_regular_detections - AttributeError: 'PDFProcessor' object has no attribute 'config'
ERROR tests/test_performance_enhanced.py::TestPerformanceOptimizedProcessor::test_processor_initialization - KeyError: 'performance'
ERROR tests/test_performance_enhanced.py::TestPerformanceOptimizedProcessor::test_optimized_processing_session - KeyError: 'performance'
ERROR tests/test_performance_enhanced.py::TestPerformanceOptimizedProcessor::test_parallel_file_processing - KeyError: 'performance'
ERROR tests/test_performance_enhanced.py::TestPerformanceOptimizedProcessor::test_empty_files_processing - KeyError: 'performance'
ERROR tests/test_performance_enhanced.py::TestPerformanceOptimizedProcessor::test_single_file_processing_with_caching - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestParallelProcessor::test_determine_processing_mode - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestParallelProcessor::test_process_single_document - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestParallelProcessor::test_process_batch_sequential - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestParallelProcessor::test_process_batch_parallel_threads - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestParallelProcessor::test_execute_task - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestParallelProcessor::test_execute_task_with_error - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestBatchEngine::test_submit_batch - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestBatchEngine::test_process_next_batch - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestBatchEngine::test_get_queue_stats - KeyError: 'performance'
ERROR tests/test_performance_optimizer.py::TestBatchEngine::test_process_empty_queue - KeyError: 'performance'
ERROR tests/test_training_data_collector.py::TestTrainingDataStorage::test_storage_initialization - PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\tomas\\AppData\\Local\\Temp\\tmp76ktpki3\\training_data.db'
ERROR tests/adaptive/test_coordinator.py::test_initialization - AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the ...
ERROR tests/adaptive/test_coordinator.py::test_process_feedback_and_learn_cycle - AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the ...
ERROR tests/adaptive/test_coordinator.py::test_process_feedback_with_no_new_pii - AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the ...
ERROR tests/adaptive/test_coordinator.py::test_ab_testing_integration - AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the ...
ERROR tests/adaptive/test_coordinator.py::test_evaluate_and_log_ab_test - AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the ...
ERROR tests/adaptive/test_coordinator.py::test_close_method - AttributeError: <module 'app.core.adaptive.coordinator' from 'C:\\Users\\tomas\\Desktop\\0001 DUOMENU ANALITIKA\\038_AnonymPDF\\app\\core\\adaptive\\coordinator.py'> does not have the ...
ERROR tests/system/test_adaptive_workflow.py::test_fixture_creation - TypeError: QualityAnalyzer.__init__() got an unexpected keyword argument 'storage_path'
ERROR tests/system/test_adaptive_workflow.py::test_feedback_creates_pattern_and_overrides_prediction - TypeError: QualityAnalyzer.__init__() got an unexpected keyword argument 'storage_path'
ERROR tests/system/test_adaptive_workflow.py::test_ab_testing_full_lifecycle - TypeError: QualityAnalyzer.__init__() got an unexpected keyword argument 'storage_path'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_add_detection_result - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_add_detection_result_with_ground_truth - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_analyze_detection_quality_single_category - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_analyze_detection_quality_multiple_categories - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_analyze_detection_quality_with_document_type_filter - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_analyze_detection_quality_with_ground_truth - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_detect_quality_issues_low_confidence - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_detect_quality_issues_performance_degradation - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_detect_quality_issues_high_false_positive - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_quality_report_empty - AttributeError: 'QualityAnalyzer' object has no attribute 'get_quality_report'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_quality_report_with_data - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_improvement_suggestions_no_issues - AttributeError: 'QualityAnalyzer' object has no attribute 'get_improvement_suggestions'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_improvement_suggestions_with_issues - AttributeError: 'QualityAnalyzer' object has no attribute 'quality_issues'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_storage_integration - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_quality_trends_insufficient_data - AttributeError: 'QualityAnalyzer' object has no attribute 'get_quality_trends'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_quality_trends_valid_metric - AttributeError: 'QualityAnalyzer' object has no attribute 'storage_path'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_quality_trends_declining - AttributeError: 'QualityAnalyzer' object has no attribute 'storage_path'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_get_quality_trends_invalid_metric - AttributeError: 'QualityAnalyzer' object has no attribute 'get_quality_trends'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_thread_safety - AttributeError: 'QualityAnalyzer' object has no attribute 'detection_history'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_config_integration - AttributeError: 'QualityAnalyzer' object has no attribute 'storage_path'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_ml_integration_compatibility - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityAnalyzer::test_performance_impact - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_pattern_insights_empty - AttributeError: 'QualityInsightsGenerator' object has no attribute 'generate_pattern_insights'
FAILED tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_pattern_insights_with_data - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_model_insights_insufficient_data - AttributeError: 'QualityInsightsGenerator' object has no attribute 'generate_model_insights'
FAILED tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_model_insights_excellent_model - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_model_insights_needs_improvement - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestQualityInsightsGenerator::test_generate_report_with_data - AttributeError: 'QualityAnalyzer' object has no attribute 'add_detection_result'
FAILED tests/test_analytics_engine.py::TestAnalyticsEngineIntegration::test_full_analysis_workflow - AttributeError: 'TestAnalyticsEngineIntegration' object has no attribute 'create_mock_detection_result'
FAILED tests/test_config_manager.py::TestConfigManager::test_configuration_validation - assert False is True
FAILED tests/test_feedback_system.py::TestFeedbackSystemIntegration::test_feedback_submission_and_processing_flow - AttributeError: <app.core.training_data.TrainingDataCollector object at 0x000001B12607F210> does not have the attribute 'save_training_examples'
FAILED tests/test_intelligent_cache.py::TestCacheDecorator::test_function_result_caching - KeyError: 'performance'
FAILED tests/test_intelligent_cache.py::TestCacheDecorator::test_custom_key_function - KeyError: 'performance'
FAILED tests/test_memory_optimizer.py::TestIntegration::test_memory_threshold_handling - AssertionError: MemoryMonitor should log a warning for high memory usage
FAILED tests/test_morning_ses5_improvements.py::TestMorningSes5Patterns::test_enhanced_car_plate_contextual_pattern - AttributeError: 'PDFProcessor' object has no attribute 'patterns'
FAILED tests/test_morning_ses5_improvements.py::TestMorningSes5Patterns::test_enhanced_car_plate_enhanced_pattern - AttributeError: 'PDFProcessor' object has no attribute 'patterns'
FAILED tests/test_morning_ses5_improvements.py::TestMorningSes5Patterns::test_lithuanian_name_all_caps_pattern - AttributeError: 'PDFProcessor' object has no attribute 'patterns'
FAILED tests/test_morning_ses5_improvements.py::TestMorningSes5Patterns::test_lithuanian_name_contextual_pattern - AttributeError: 'PDFProcessor' object has no attribute 'patterns'
FAILED tests/test_morning_ses5_improvements.py::TestMorningSes5Patterns::test_lithuanian_name_contextual_caps_pattern - AttributeError: 'PDFProcessor' object has no attribute 'patterns'
FAILED tests/test_morning_ses5_improvements.py::TestMorningSes5Patterns::test_lithuanian_address_flexible_pattern - AttributeError: 'PDFProcessor' object has no attribute 'patterns'
FAILED tests/test_morning_ses5_improvements.py::TestMorningSes5Patterns::test_lithuanian_personal_code_contextual_pattern - AttributeError: 'PDFProcessor' object has no attribute 'patterns'
FAILED tests/test_morning_ses5_improvements.py::TestMorningSes5Integration::test_comprehensive_lithuanian_document_processing - KeyError: 'names'
FAILED tests/test_morning_ses5_improvements.py::TestMorningSes5Integration::test_anti_overredaction_in_technical_context - KeyError: 'names'
FAILED tests/test_pdf_processor.py::test_find_personal_info - AttributeError: <app.services.pdf_processor.PDFProcessor object at 0x000001B099C54790> has no attribute 'patterns'
FAILED tests/test_pdf_processor.py::test_generate_redaction_report - AttributeError: <app.services.pdf_processor.PDFProcessor object at 0x000001B099C54790> has no attribute 'patterns'
FAILED tests/test_pdf_processor.py::test_process_pdf_failure_on_invalid_content - AssertionError: assert 'Failed to open document' in 'An exception occurred during anonymization'
FAILED tests/test_performance.py::TestPerformanceIntegration::test_get_performance_report - KeyError: 'performance'
FAILED tests/test_performance_enhanced.py::TestGlobalFunctions::test_get_performance_report - TypeError: 'dict' object does not support the context manager protocol
FAILED tests/test_performance_enhanced.py::TestGlobalFunctions::test_get_parallel_processor - KeyError: 'performance'
FAILED tests/test_performance_enhanced.py::TestGlobalFunctions::test_performance_report_with_optimizers - KeyError: 'performance'
FAILED tests/test_performance_enhanced.py::TestIntegration::test_end_to_end_parallel_processing - KeyError: 'performance'
FAILED tests/test_performance_enhanced.py::TestIntegration::test_concurrent_metric_collection - KeyError: 'performance'
FAILED tests/test_performance_enhanced.py::TestIntegration::test_performance_under_load - KeyError: 'performance'
FAILED tests/test_performance_optimizer.py::TestGlobalInstances::test_get_parallel_processor - KeyError: 'performance'
FAILED tests/test_performance_optimizer.py::TestGlobalInstances::test_get_batch_engine - KeyError: 'performance'
FAILED tests/test_performance_optimizer.py::TestIntegration::test_end_to_end_processing - KeyError: 'performance'
FAILED tests/test_performance_optimizer.py::TestIntegration::test_performance_improvement_simulation - KeyError: 'performance'
FAILED tests/test_real_time_monitor.py::TestAnomalyDetector::test_alert_threshold_integration - assert 0 > 0
FAILED tests/test_real_time_monitor.py::TestRealTimeMonitor::test_ml_monitor_callback_functionality - AssertionError: assert 0 == 1
FAILED tests/test_real_time_monitor.py::TestRealTimeMonitor::test_alert_callback_system - TypeError: Object of type Mock is not JSON serializable
FAILED tests/test_training_data_collector.py::TestTrainingDataStorage::test_save_and_load_training_examples - TypeError: create_dummy_example() got an unexpected keyword argument 'source'
FAILED tests/test_training_data_collector.py::TestTrainingDataStorage::test_get_dataset_stats_empty - AttributeError: 'NoneType' object has no attribute 'total_samples'
FAILED tests/test_training_data_collector.py::TestTrainingDataCollector::test_get_balanced_training_set_with_data - assert 6 == 13
FAILED tests/test_validation_utils.py::TestPersonNameValidation::test_length_validation - AssertionError: assert not True
FAILED tests/adaptive/test_ab_testing.py::TestABTestManager::test_record_and_evaluate_metrics_variant_wins - KeyError: 'winner'
FAILED tests/adaptive/test_online_learner.py::TestOnlineLearner::test_retrain_model_saves_examples_and_triggers_retraining - AttributeError: 'OnlineLearner' object has no attribute 'retrain_model'
FAILED tests/adaptive/test_online_learner.py::TestOnlineLearner::test_retrain_model_saves_examples_but_skips_retraining - AttributeError: 'OnlineLearner' object has no attribute 'retrain_model'
FAILED tests/adaptive/test_pattern_learner.py::TestPatternLearner::test_discover_and_validate_patterns - assert 0 == 1
================================================================== 68 failed, 270 passed, 55 errors in 100.62s (0:01:40) ===================================================================
(venv) PS C:\Users\tomas\Desktop\0001 DUOMENU ANALITIKA\038_AnonymPDF>